(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[979],{4307:function(e,t,r){"use strict";r.r(t),r.d(t,{Headers:function(){return a},Request:function(){return s},Response:function(){return o},fetch:function(){return n}});var i=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw Error("unable to locate global object")}();let n=i.fetch;t.default=i.fetch.bind(i);let a=i.Headers,s=i.Request,o=i.Response},6781:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(r(4307)),a=i(r(7960));class s{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=n.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,i;let n=null,s=null,o=null,l=e.status,u=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(s="text/csv"===this.headers.Accept?t:this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let i=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),a=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");i&&a&&a.length>1&&(o=parseInt(a[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(s)&&(s.length>1?(n={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,o=null,l=406,u="Not Acceptable"):s=1===s.length?s[0]:null)}else{let t=await e.text();try{n=JSON.parse(t),Array.isArray(n)&&404===e.status&&(s=[],n=null,l=200,u="OK")}catch(r){404===e.status&&""===t?(l=204,u="No Content"):n={message:t}}if(n&&this.isMaybeSingle&&(null===(i=null==n?void 0:n.details)||void 0===i?void 0:i.includes("0 rows"))&&(n=null,l=200,u="OK"),n&&this.shouldThrowOnError)throw new a.default(n)}return{error:n,data:s,count:o,status:l,statusText:u}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,i;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(i=null==e?void 0:e.code)&&void 0!==i?i:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}}t.default=s},8895:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(r(9660)),a=i(r(3287)),s=r(1395);class o{constructor(e,{headers:t={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=i}from(e){let t=new URL(`${this.url}/${e}`);return new n.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:i=!1,count:n}={}){let s,o;let l=new URL(`${this.url}/rpc/${e}`);r||i?(s=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(s="POST",o=t);let u=Object.assign({},this.headers);return n&&(u.Prefer=`count=${n}`),new a.default({method:s,url:l,headers:u,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}}t.default=o},7960:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},3287:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(r(3432));class a extends n.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:i}={}){let n="";"plain"===i?n="pl":"phrase"===i?n="ph":"websearch"===i&&(n="w");let a=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}t.default=a},9660:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(r(3287));class a{constructor(e,{headers:t={},schema:r,fetch:i}){this.url=e,this.headers=t,this.schema=r,this.fetch=i}select(e,{head:t=!1,count:r}={}){let i=!1,a=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new n.default({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){let i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:i,defaultToNull:a=!0}={}){let s=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&s.push(this.headers.Prefer),i&&s.push(`count=${i}`),a||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new n.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new n.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new n.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}t.default=a},3432:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});let n=i(r(6781));class a extends n.default{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:i,referencedTable:n=i}={}){let a=n?`${n}.order`:"order",s=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:i=r}={}){let n=void 0===i?"offset":`${i}.offset`,a=void 0===i?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:i=!1,wal:n=!1,format:a="text"}={}){var s;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(s=this.headers.Accept)&&void 0!==s?s:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=a},1395:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;let i=r(4373);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${i.version}`}},8292:function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;let n=i(r(8895));t.PostgrestClient=n.default;let a=i(r(9660));t.PostgrestQueryBuilder=a.default;let s=i(r(3287));t.PostgrestFilterBuilder=s.default;let o=i(r(3432));t.PostgrestTransformBuilder=o.default;let l=i(r(6781));t.PostgrestBuilder=l.default;let u=i(r(7960));t.PostgrestError=u.default,t.default={PostgrestClient:n.default,PostgrestQueryBuilder:a.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:u.default}},4373:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},4593:function(e,t,r){"use strict";r.d(t,{eI:function(){return tL}});let i=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(r.bind(r,4307)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)};class n extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class a extends n{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class s extends n{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class o extends n{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}(F=H||(H={})).Any="any",F.ApNortheast1="ap-northeast-1",F.ApNortheast2="ap-northeast-2",F.ApSouth1="ap-south-1",F.ApSoutheast1="ap-southeast-1",F.ApSoutheast2="ap-southeast-2",F.CaCentral1="ca-central-1",F.EuCentral1="eu-central-1",F.EuWest1="eu-west-1",F.EuWest2="eu-west-2",F.EuWest3="eu-west-3",F.SaEast1="sa-east-1",F.UsEast1="us-east-1",F.UsWest1="us-west-1",F.UsWest2="us-west-2";class l{constructor(e,{headers:t={},customFetch:r,region:n=H.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=i(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r,i,n,l,u;return i=this,n=void 0,l=void 0,u=function*(){try{let i;let{headers:n,method:l,body:u}=t,c={},{region:d}=t;d||(d=this.region),d&&"any"!==d&&(c["x-region"]=d),u&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&u instanceof Blob||u instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",i=u):"string"==typeof u?(c["Content-Type"]="text/plain",i=u):"undefined"!=typeof FormData&&u instanceof FormData?i=u:(c["Content-Type"]="application/json",i=JSON.stringify(u)));let h=yield this.fetch(`${this.url}/${e}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),n),body:i}).catch(e=>{throw new a(e)}),f=h.headers.get("x-relay-error");if(f&&"true"===f)throw new s(h);if(!h.ok)throw new o(h);let p=(null!==(r=h.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return{data:"application/json"===p?yield h.json():"application/octet-stream"===p?yield h.blob():"text/event-stream"===p?h:"multipart/form-data"===p?yield h.formData():yield h.text(),error:null}}catch(e){return{data:null,error:e}}},new(l||(l=Promise))(function(e,t){function r(e){try{s(u.next(e))}catch(e){t(e)}}function a(e){try{s(u.throw(e))}catch(e){t(e)}}function s(t){var i;t.done?e(t.value):((i=t.value)instanceof l?i:new l(function(e){e(i)})).then(r,a)}s((u=u.apply(i,n||[])).next())})}}let{PostgrestClient:u,PostgrestQueryBuilder:c,PostgrestFilterBuilder:d,PostgrestTransformBuilder:h,PostgrestBuilder:f}=r(8292),p={"X-Client-Info":"realtime-js/2.10.7"};(ee=z||(z={}))[ee.connecting=0]="connecting",ee[ee.open=1]="open",ee[ee.closing=2]="closing",ee[ee.closed=3]="closed",(et=W||(W={})).closed="closed",et.errored="errored",et.joined="joined",et.joining="joining",et.leaving="leaving",(er=V||(V={})).close="phx_close",er.error="phx_error",er.join="phx_join",er.reply="phx_reply",er.leave="phx_leave",er.access_token="access_token",(G||(G={})).websocket="websocket",(ei=K||(K={})).Connecting="connecting",ei.Open="open",ei.Closing="closing",ei.Closed="closed";class v{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let i=t.getUint8(1),n=t.getUint8(2),a=this.HEADER_LENGTH+2,s=r.decode(e.slice(a,a+i));a+=i;let o=r.decode(e.slice(a,a+n));return a+=n,{ref:null,topic:s,event:o,payload:JSON.parse(r.decode(e.slice(a,e.byteLength)))}}}class m{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(en=J||(J={})).abstime="abstime",en.bool="bool",en.date="date",en.daterange="daterange",en.float4="float4",en.float8="float8",en.int2="int2",en.int4="int4",en.int4range="int4range",en.int8="int8",en.int8range="int8range",en.json="json",en.jsonb="jsonb",en.money="money",en.numeric="numeric",en.oid="oid",en.reltime="reltime",en.text="text",en.time="time",en.timestamp="timestamp",en.timestamptz="timestamptz",en.timetz="timetz",en.tsrange="tsrange",en.tstzrange="tstzrange";let y=(e,t,r={})=>{var i;let n=null!==(i=r.skipTypes)&&void 0!==i?i:[];return Object.keys(t).reduce((r,i)=>(r[i]=_(i,e,t,n),r),{})},_=(e,t,r,i)=>{let n=t.find(t=>t.name===e),a=null==n?void 0:n.type,s=r[e];return a&&!i.includes(a)?g(a,s):b(s)},g=(e,t)=>{if("_"===e.charAt(0))return E(t,e.slice(1,e.length));switch(e){case J.bool:return w(t);case J.float4:case J.float8:case J.int2:case J.int4:case J.int8:case J.numeric:case J.oid:return T(t);case J.json:case J.jsonb:return k(t);case J.timestamp:return S(t);case J.abstime:case J.date:case J.daterange:case J.int4range:case J.int8range:case J.money:case J.reltime:case J.text:case J.time:case J.timestamptz:case J.timetz:case J.tsrange:case J.tstzrange:default:return b(t)}},b=e=>e,w=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},T=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},k=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},E=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,i=e[r];if("{"===e[0]&&"}"===i){let i;let n=e.slice(1,r);try{i=JSON.parse("["+n+"]")}catch(e){i=n?n.split(","):[]}return i.map(e=>g(t,e))}return e},S=e=>"string"==typeof e?e.replace(" ","T"):e,x=e=>{let t=e;return(t=(t=t.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")};class O{constructor(e,t,r={},i=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}(ea=Q||(Q={})).SYNC="sync",ea.JOIN="join",ea.LEAVE="leave";class A{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=A.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=A.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],i()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=A.syncDiff(this.state,e,t,r),i())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,i){let n=this.cloneDeep(e),a=this.transformState(t),s={},o={};return this.map(n,(e,t)=>{a[e]||(o[e]=t)}),this.map(a,(e,t)=>{let r=n[e];if(r){let i=t.map(e=>e.presence_ref),n=r.map(e=>e.presence_ref),a=t.filter(e=>0>n.indexOf(e.presence_ref)),l=r.filter(e=>0>i.indexOf(e.presence_ref));a.length>0&&(s[e]=a),l.length>0&&(o[e]=l)}else s[e]=t}),this.syncDiff(n,{joins:s,leaves:o},r,i)}static syncDiff(e,t,r,i){let{joins:n,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(n,(t,i)=>{var n;let a=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(i),a.length>0){let r=e[t].map(e=>e.presence_ref),i=a.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...i)}r(t,a,i)}),this.map(a,(t,r)=>{let n=e[t];if(!n)return;let a=r.map(e=>e.presence_ref);n=n.filter(e=>0>a.indexOf(e.presence_ref)),e[t]=n,i(t,n,r),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let i=e[r];return"metas"in i?t[r]=i.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(es=Y||(Y={})).ALL="*",es.INSERT="INSERT",es.UPDATE="UPDATE",es.DELETE="DELETE",(eo=X||(X={})).BROADCAST="broadcast",eo.PRESENCE="presence",eo.POSTGRES_CHANGES="postgres_changes",eo.SYSTEM="system",(el=Z||(Z={})).SUBSCRIBED="SUBSCRIBED",el.TIMED_OUT="TIMED_OUT",el.CLOSED="CLOSED",el.CHANNEL_ERROR="CHANNEL_ERROR";class R{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=W.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new O(this,V.join,this.params,this.timeout),this.rejoinTimer=new m(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=W.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=W.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=W.errored,this.rejoinTimer.scheduleTimeout())}),this._on(V.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new A(this),this.broadcastEndpointURL=x(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:n,presence:a,private:s}}=this.params;this._onError(t=>e&&e("CHANNEL_ERROR",t)),this._onClose(()=>e&&e("CLOSED"));let o={},l={broadcast:n,presence:a,postgres_changes:null!==(i=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==i?i:[],private:s};this.socket.accessToken&&(o.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:t})=>{var r;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0===t){e&&e("SUBSCRIBED");return}{let i=this.bindings.postgres_changes,n=null!==(r=null==i?void 0:i.length)&&void 0!==r?r:0,a=[];for(let r=0;r<n;r++){let n=i[r],{filter:{event:s,schema:o,table:l,filter:u}}=n,c=t&&t[r];if(c&&c.event===s&&c.schema===o&&c.table===l&&c.filter===u)a.push(Object.assign(Object.assign({},n),{id:c.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=a,e&&e("SUBSCRIBED");return}}).receive("error",t=>{e&&e("CHANNEL_ERROR",Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,i;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var i,n,a;let s=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(a=null===(n=null===(i=this.params)||void 0===i?void 0:i.config)||void 0===n?void 0:n.broadcast)||void 0===a?void 0:a.ack)||r("ok"),s.receive("ok",()=>r("ok")),s.receive("error",()=>r("error")),s.receive("timeout",()=>r("timed out"))});{let{event:n,payload:a}=e,s={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:a,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,s,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await (null===(i=e.body)||void 0===i?void 0:i.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=W.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(V.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let i=new O(this,V.leave,{},e);i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){let i=new AbortController,n=setTimeout(()=>i.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(n),a}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new O(this,e,t,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var i,n;let a=e.toLocaleLowerCase(),{close:s,error:o,leave:l,join:u}=V;if(r&&[s,o,l,u].indexOf(a)>=0&&r!==this._joinRef())return;let c=this._onMessage(a,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null===(i=this.bindings.postgres_changes)||void 0===i||i.filter(e=>{var t,r,i;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(i=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===i?void 0:i.toLocaleLowerCase())===a}).map(e=>e.callback(c,r)):null===(n=this.bindings[a])||void 0===n||n.filter(e=>{var r,i,n,s,o,l;if(!["broadcast","presence","postgres_changes"].includes(a))return e.type.toLocaleLowerCase()===a;if("id"in e){let a=e.id,s=null===(r=e.filter)||void 0===r?void 0:r.event;return a&&(null===(i=t.ids)||void 0===i?void 0:i.includes(a))&&("*"===s||(null==s?void 0:s.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{let r=null===(o=null===(s=null==e?void 0:e.filter)||void 0===s?void 0:s.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:r,commit_timestamp:i,type:n,errors:a}=e;c=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:i,eventType:n,new:{},old:{},errors:a}),this._getPayloadRecords(e))}e.callback(c,r)})}_isClosed(){return this.state===W.closed}_isJoined(){return this.state===W.joined}_isJoining(){return this.state===W.joining}_isLeaving(){return this.state===W.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let i=e.toLocaleLowerCase(),n={type:i,filter:t,callback:r};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(e=>{var i;return!((null===(i=e.type)||void 0===i?void 0:i.toLocaleLowerCase())===r&&R.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(V.close,{},e)}_onError(e){this._on(V.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=W.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=y(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=y(e.columns,e.old_record)),t}}let P=()=>{},D="undefined"!=typeof WebSocket,L=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class C{constructor(e,t){var i;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=p,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=P,this.conn=null,this.sendBuffer=[],this.serializer=new v,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(r.bind(r,4307)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},this.endPoint=`${e}/${G.websocket}`,this.httpEndpoint=x(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let n=null===(i=null==t?void 0:t.params)||void 0===i?void 0:i.apikey;if(n&&(this.accessToken=n,this.apiKey=n),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new m(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(D){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new I(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),r.e(35).then(r.t.bind(r,7035,23)).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case z.connecting:return K.Connecting;case z.open:return K.Open;case z.closing:return K.Closing;default:return K.Closed}}isConnected(){return this.connectionState()===K.Open}channel(e,t={config:{}}){let r=new R(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){let{topic:t,event:r,payload:i,ref:n}=e,a=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${n})`,i),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(V.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:i,ref:n}=e;(n&&n===this.pendingHeartbeatRef||r===(null==i?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${t} ${r} ${n&&"("+n+")"||""}`,i),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,i,n)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}async _onConnOpen(){if(this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this._sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(V.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${r}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([L],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class I{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=z.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class j extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function N(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class U extends j{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class q extends j{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let $=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(r.bind(r,4307)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},B=()=>{var e,t,i,n;return e=void 0,t=void 0,i=void 0,n=function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(r.bind(r,4307))).Response:Response},new(i||(i=Promise))(function(r,a){function s(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(s,o)}l((n=n.apply(e,t||[])).next())})},M=e=>{if(Array.isArray(e))return e.map(e=>M(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=M(r)}),t};var F,H,z,W,V,G,K,J,Q,Y,X,Z,ee,et,er,ei,en,ea,es,eo,el,eu=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((i=i.apply(e,t||[])).next())})};let ec=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ed=(e,t,r)=>eu(void 0,void 0,void 0,function*(){e instanceof(yield B())&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{t(new U(ec(r),e.status||500))}).catch(e=>{t(new q(ec(e),e))}):t(new q(ec(e),e))}),eh=(e,t,r,i)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),i&&(n.body=JSON.stringify(i)),Object.assign(Object.assign({},n),r))};function ef(e,t,r,i,n,a){return eu(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,eh(t,i,n,a)).then(e=>{if(!e.ok)throw e;return(null==i?void 0:i.noResolveJson)?e:e.json()}).then(e=>s(e)).catch(e=>ed(e,o,i))})})}function ep(e,t,r,i){return eu(this,void 0,void 0,function*(){return ef(e,"GET",t,r,i)})}function ev(e,t,r,i,n){return eu(this,void 0,void 0,function*(){return ef(e,"POST",t,i,n,r)})}function em(e,t,r,i,n){return eu(this,void 0,void 0,function*(){return ef(e,"DELETE",t,i,n,r)})}var ey=r(6300).Buffer,e_=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((i=i.apply(e,t||[])).next())})};let eg={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eb={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ew{constructor(e,t={},r,i){this.url=e,this.headers=t,this.bucketId=r,this.fetch=$(i)}uploadOrUpdate(e,t,r,i){return e_(this,void 0,void 0,function*(){try{let n;let a=Object.assign(Object.assign({},eb),i),s=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(a.upsert)}),o=a.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((n=new FormData).append("cacheControl",a.cacheControl),o&&n.append("metadata",this.encodeMetadata(o)),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((n=r).append("cacheControl",a.cacheControl),o&&n.append("metadata",this.encodeMetadata(o))):(n=r,s["cache-control"]=`max-age=${a.cacheControl}`,s["content-type"]=a.contentType,o&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==i?void 0:i.headers)&&(s=Object.assign(Object.assign({},s),i.headers));let l=this._removeEmptyFolders(t),u=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:n,headers:s},(null==a?void 0:a.duplex)?{duplex:a.duplex}:{})),d=yield c.json();if(c.ok)return{data:{path:l,id:d.Id,fullPath:d.Key},error:null};return{data:null,error:d}}catch(e){if(N(e))return{data:null,error:e};throw e}})}upload(e,t,r){return e_(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,i){return e_(this,void 0,void 0,function*(){let n=this._removeEmptyFolders(e),a=this._getFinalPath(n),s=new URL(this.url+`/object/upload/sign/${a}`);s.searchParams.set("token",t);try{let e;let t=Object.assign({upsert:eb.upsert},i),a=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,a["cache-control"]=`max-age=${t.cacheControl}`,a["content-type"]=t.contentType);let o=yield this.fetch(s.toString(),{method:"PUT",body:e,headers:a}),l=yield o.json();if(o.ok)return{data:{path:n,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(N(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e,t){return e_(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(i["x-upsert"]="true");let n=yield ev(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),a=new URL(this.url+n.url),s=a.searchParams.get("token");if(!s)throw new j("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:s},error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}update(e,t,r){return e_(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return e_(this,void 0,void 0,function*(){try{return{data:yield ev(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}copy(e,t,r){return e_(this,void 0,void 0,function*(){try{return{data:{path:(yield ev(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return e_(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),n=yield ev(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),a=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n={signedUrl:encodeURI(`${this.url}${n.signedURL}${a}`)},error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return e_(this,void 0,void 0,function*(){try{let i=yield ev(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:i.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}download(e,t){return e_(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=i?`?${i}`:"";try{let t=this._getFinalPath(e),i=yield ep(this.fetch,`${this.url}/${r?"render/image/authenticated":"object"}/${t}${n}`,{headers:this.headers,noResolveJson:!0});return{data:yield i.blob(),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}info(e){return e_(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{let e=yield ep(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:M(e),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}exists(e){return e_(this,void 0,void 0,function*(){let t=this._getFinalPath(e);try{return yield function(e,t,r,i){return eu(this,void 0,void 0,function*(){return ef(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),void 0)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(N(e)&&e instanceof q){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),i=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&i.push(n);let a=void 0!==(null==t?void 0:t.transform),s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==s&&i.push(s);let o=i.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a?"render/image":"object"}/public/${r}${o}`)}}}remove(e){return e_(this,void 0,void 0,function*(){try{return{data:yield em(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}list(e,t,r){return e_(this,void 0,void 0,function*(){try{let i=Object.assign(Object.assign(Object.assign({},eg),t),{prefix:e||""});return{data:yield ev(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return void 0!==ey?ey.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let eT={"X-Client-Info":"storage-js/2.7.1"};var ek=function(e,t,r,i){return new(r||(r=Promise))(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((i=i.apply(e,t||[])).next())})};class eE{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},eT),t),this.fetch=$(r)}listBuckets(){return ek(this,void 0,void 0,function*(){try{return{data:yield ep(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}getBucket(e){return ek(this,void 0,void 0,function*(){try{return{data:yield ep(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return ek(this,void 0,void 0,function*(){try{return{data:yield ev(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return ek(this,void 0,void 0,function*(){try{return{data:yield function(e,t,r,i,n){return eu(this,void 0,void 0,function*(){return ef(e,"PUT",t,i,void 0,r)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}emptyBucket(e){return ek(this,void 0,void 0,function*(){try{return{data:yield ev(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}deleteBucket(e){return ek(this,void 0,void 0,function*(){try{return{data:yield em(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(N(e))return{data:null,error:e};throw e}})}}class eS extends eE{constructor(e,t={},r){super(e,t,r)}from(e){return new ew(this.url,this.headers,e,this.fetch)}}let ex="";"undefined"!=typeof Deno?ex="deno":"undefined"!=typeof document?ex="web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?ex="react-native":ex="node";let eO={headers:{"X-Client-Info":`supabase-js-${ex}/2.45.6`}},eA={schema:"public"},eR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},eP={};var eD=r(4307);let eL=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=eD.default:t=fetch,(...e)=>t(...e)},eC=()=>"undefined"==typeof Headers?eD.Headers:Headers,eI=(e,t,r)=>{let i=eL(r),n=eC();return(r,a)=>{var s,o,l,u;return s=void 0,o=void 0,l=void 0,u=function*(){var s;let o=null!==(s=yield t())&&void 0!==s?s:e,l=new n(null==a?void 0:a.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),i(r,Object.assign(Object.assign({},a),{headers:l}))},new(l||(l=Promise))(function(e,t){function r(e){try{n(u.next(e))}catch(e){t(e)}}function i(e){try{n(u.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):((n=t.value)instanceof l?n:new l(function(e){e(n)})).then(r,i)}n((u=u.apply(s,o||[])).next())})}},ej="2.65.1",eN={"X-Client-Info":`gotrue-js/${ej}`},eU="X-Supabase-Api-Version",eq={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},e$=()=>"undefined"!=typeof document,eB={tested:!1,writable:!1},eM=()=>{if(!e$())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(eB.tested)return eB.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),eB.tested=!0,eB.writable=!0}catch(e){eB.tested=!0,eB.writable=!1}return eB.writable};function eF(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}let eH=e=>{let t;return e?t=e:"undefined"==typeof fetch?t=(...e)=>Promise.resolve().then(r.bind(r,4307)).then(({default:t})=>t(...e)):t=fetch,(...e)=>t(...e)},ez=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,eW=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},eV=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},eG=async(e,t)=>{await e.removeItem(t)};class eK{constructor(){this.promise=new eK.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function eJ(e){let t=e.split(".");if(3!==t.length)throw Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw Error("JWT is not valid: payload is not in base64url format");return JSON.parse(function(e){let t,r,i,n,a,s,o;let l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",c=0;for(e=e.replace("-","+").replace("_","/");c<e.length;)n=l.indexOf(e.charAt(c++)),a=l.indexOf(e.charAt(c++)),s=l.indexOf(e.charAt(c++)),o=l.indexOf(e.charAt(c++)),t=n<<2|a>>4,r=(15&a)<<4|s>>2,i=(3&s)<<6|o,u+=String.fromCharCode(t),64!=s&&0!=r&&(u+=String.fromCharCode(r)),64!=o&&0!=i&&(u+=String.fromCharCode(i));return u}(t[1]))}async function eQ(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function eY(e){return("0"+e.toString(16)).substr(-2)}async function eX(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function eZ(e){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder?btoa(await eX(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}async function e0(e,t,r=!1){let i=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let i=0;i<56;i++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,eY).join("")}(),n=i;r&&(n+="/PASSWORD_RECOVERY"),await eW(e,`${t}-code-verifier`,n);let a=await eZ(i),s=i===a?"plain":"s256";return[a,s]}eK.promiseConstructor=Promise;let e1=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class e2 extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function e8(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class e4 extends e2{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class e5 extends e2{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class e3 extends e2{constructor(e,t,r,i){super(e,r,i),this.name=t,this.status=r}}class e6 extends e3{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class e7 extends e3{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class e9 extends e3{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class te extends e3{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tt extends e3{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tr extends e3{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ti(e){return e8(e)&&"AuthRetryableFetchError"===e.name}class tn extends e3{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var ta=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};let ts=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),to=[502,503,504];async function tl(e){var t;let r,i;if(!ez(e))throw new tr(ts(e),0);if(to.includes(e.status))throw new tr(ts(e),e.status);try{r=await e.json()}catch(e){throw new e5(ts(e),e)}let n=function(e){let t=e.headers.get(eU);if(!t||!t.match(e1))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(n&&n.getTime()>=eq["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?i=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(i=r.error_code),i){if("weak_password"===i)throw new tn(ts(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===i)throw new e6}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new tn(ts(r),e.status,r.weak_password.reasons);throw new e4(ts(r),e.status||500,i)}let tu=(e,t,r,i)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(i),Object.assign(Object.assign({},n),r))};async function tc(e,t,r,i){var n;let a=Object.assign({},null==i?void 0:i.headers);a[eU]||(a[eU]=eq["2024-01-01"].name),(null==i?void 0:i.jwt)&&(a.Authorization=`Bearer ${i.jwt}`);let s=null!==(n=null==i?void 0:i.query)&&void 0!==n?n:{};(null==i?void 0:i.redirectTo)&&(s.redirect_to=i.redirectTo);let o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await td(e,t,r+o,{headers:a,noResolveJson:null==i?void 0:i.noResolveJson},{},null==i?void 0:i.body);return(null==i?void 0:i.xform)?null==i?void 0:i.xform(l):{data:Object.assign({},l),error:null}}async function td(e,t,r,i,n,a){let s;let o=tu(t,i,n,a);try{s=await e(r,Object.assign({},o))}catch(e){throw console.error(e),new tr(ts(e),0)}if(s.ok||await tl(s),null==i?void 0:i.noResolveJson)return s;try{return await s.json()}catch(e){await tl(e)}}function th(e){var t,r;let i=null;return e.access_token&&e.refresh_token&&e.expires_in&&(i=Object.assign({},e),!e.expires_at)&&(i.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)),{data:{session:i,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tf(e){let t=th(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function tp(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tv(e){return{data:e,error:null}}function tm(e){let{action_link:t,email_otp:r,hashed_token:i,redirect_to:n,verification_type:a}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:i,redirect_to:n,verification_type:a},user:Object.assign({},ta(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function ty(e){return e}var t_=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};class tg{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=eH(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await tc(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(e8(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await tc(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tp})}catch(e){if(e8(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=t_(e,["options"]),i=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(i.new_email=null==r?void 0:r.newEmail,delete i.newEmail),await tc(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:tm,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(e8(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await tc(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tp})}catch(e){if(e8(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,i,n,a,s,o;try{let l={nextPage:null,lastPage:0,total:0},u=await tc(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(n=null===(i=null==e?void 0:e.perPage)||void 0===i?void 0:i.toString())&&void 0!==n?n:""},xform:ty});if(u.error)throw u.error;let c=await u.json(),d=null!==(a=u.headers.get("x-total-count"))&&void 0!==a?a:0,h=null!==(o=null===(s=u.headers.get("link"))||void 0===s?void 0:s.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(e8(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await tc(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tp})}catch(e){if(e8(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await tc(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tp})}catch(e){if(e8(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await tc(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tp})}catch(e){if(e8(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{let{data:t,error:r}=await tc(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(e8(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await tc(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(e8(e))return{data:null,error:e};throw e}}}let tb={getItem:e=>eM()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{eM()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{eM()&&globalThis.localStorage.removeItem(e)}};function tw(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let tT={debug:!!(globalThis&&eM()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class tk extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tE extends tk{}async function tS(e,t,r){tT.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),tT.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async i=>{if(i){tT.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{tT.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(0===t)throw tT.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tE(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(tT.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let tx={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:eN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function tO(e,t,r){return await r()}class tA{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=tA.nextInstanceID,tA.nextInstanceID+=1,this.instanceID>0&&e$()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let i=Object.assign(Object.assign({},tx),e);if(this.logDebugMessages=!!i.debug,"function"==typeof i.debug&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new tg({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=eH(i.fetch),this.lock=i.lock||tO,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:e$()&&(null===(t=null==globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=tS:this.lock=tO,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:eM()?this.storage=tb:(this.memoryStorage={},this.storage=tw(this.memoryStorage)):(this.memoryStorage={},this.storage=tw(this.memoryStorage)),e$()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ej}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{let e=!!e$()&&await this._isPKCEFlow();if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){let{data:t,error:r}=await this._getSessionFromURL(e);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),(null==r?void 0:r.code)==="identity_already_exists")return{error:r};return await this._removeSession(),{error:r}}let{session:i,redirectType:n}=t;return this._debug("#_initialize()","detected session in URL",i,"redirect type",n),await this._saveSession(i),setTimeout(async()=>{"recovery"===n?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(e8(e))return{error:e};return{error:new e5("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,i;try{let{data:n,error:a}=await tc(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(i=null==e?void 0:e.options)||void 0===i?void 0:i.captchaToken}},xform:th});if(a||!n)return{data:{user:null,session:null},error:a};let s=n.session,o=n.user;return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",s)),{data:{user:o,session:s},error:null}}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,r,i;try{let n;if("email"in e){let{email:r,password:i,options:a}=e,s=null,o=null;"pkce"===this.flowType&&([s,o]=await e0(this.storage,this.storageKey)),n=await tc(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==a?void 0:a.emailRedirectTo,body:{email:r,password:i,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:s,code_challenge_method:o},xform:th})}else if("phone"in e){let{phone:t,password:a,options:s}=e;n=await tc(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:a,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},channel:null!==(i=null==s?void 0:s.channel)&&void 0!==i?i:"sms",gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:th})}else throw new e9("You must provide either an email or phone number and a password");let{data:a,error:s}=n;if(s||!a)return{data:{user:null,session:null},error:s};let o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:i,options:n}=e;t=await tc(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:tf})}else if("phone"in e){let{phone:r,password:i,options:n}=e;t=await tc(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:tf})}else throw new e9("You must provide either an email or phone number and a password");let{data:r,error:i}=t;if(i)return{data:{user:null,session:null},error:i};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new e7};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i}}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,i,n;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await eV(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(null!=t?t:"").split("/");try{let{data:t,error:n}=await tc(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:th});if(await eG(this.storage,`${this.storageKey}-code-verifier`),n)throw n;if(!t||!t.session||!t.user)return{data:{user:null,session:null,redirectType:null},error:new e7};return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=i?i:null}),error:n}}catch(e){if(e8(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:i,access_token:n,nonce:a}=e,{data:s,error:o}=await tc(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:n,nonce:a,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:th});if(o)return{data:{user:null,session:null},error:o};if(!s||!s.session||!s.user)return{data:{user:null,session:null},error:new e7};return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:s,error:o}}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,i,n,a;try{if("email"in e){let{email:i,options:n}=e,a=null,s=null;"pkce"===this.flowType&&([a,s]=await e0(this.storage,this.storageKey));let{error:o}=await tc(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(r=null==n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:a,code_challenge_method:s},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){let{phone:t,options:r}=e,{data:s,error:o}=await tc(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(i=null==r?void 0:r.data)&&void 0!==i?i:{},create_user:null===(n=null==r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(a=null==r?void 0:r.channel)&&void 0!==a?a:"sms"}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:o}}throw new e9("You must provide either an email or phone number.")}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let i,n;"options"in e&&(i=null===(t=e.options)||void 0===t?void 0:t.redirectTo,n=null===(r=e.options)||void 0===r?void 0:r.captchaToken);let{data:a,error:s}=await tc(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:i,xform:th});if(s)throw s;if(!a)throw Error("An error occurred on token verification.");let o=a.session,l=a.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,i;try{let n=null,a=null;return"pkce"===this.flowType&&([n,a]=await e0(this.storage,this.storageKey)),await tc(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(i=null==e?void 0:e.options)||void 0===i?void 0:i.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:a}),headers:this.headers,xform:tv})}catch(e){if(e8(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new e6;let{error:i}=await tc(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:i,options:n}=e,{error:a}=await tc(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){let{phone:r,type:i,options:n}=e,{data:a,error:s}=await tc(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==a?void 0:a.message_id},error:s}}throw new e9("You must provide either an email or phone number and a type")}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await eV(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,i)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,i))})}return{data:{session:e},error:null}}let{session:i,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{session:null},error:n};return{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await tc(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tp});return await this._useSession(async e=>{var t,r,i;let{data:n,error:a}=e;if(a)throw a;return(null===(t=n.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await tc(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(i=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==i?i:void 0,xform:tp}):{data:{user:null},error:new e6}})}catch(e){if(e8(e))return e8(e)&&"AuthSessionMissingError"===e.name&&(await this._removeSession(),await eG(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:i,error:n}=r;if(n)throw n;if(!i.session)throw new e6;let a=i.session,s=null,o=null;"pkce"===this.flowType&&null!=e.email&&([s,o]=await e0(this.storage,this.storageKey));let{data:l,error:u}=await tc(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:s,code_challenge_method:o}),jwt:a.access_token,xform:tp});if(u)throw u;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(e){if(e8(e))return{data:{user:null},error:e};throw e}}_decodeJWT(e){return eJ(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new e6;let t=Date.now()/1e3,r=t,i=!0,n=null,a=eJ(e.access_token);if(a.exp&&(i=(r=a.exp)<=t),i){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};n=t}else{let{data:i,error:a}=await this._getUser(e.access_token);if(a)throw a;n={access_token:e.access_token,refresh_token:e.refresh_token,user:i.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(e){if(e8(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:i,error:n}=t;if(n)throw n;e=null!==(r=i.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new e6;let{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(e8(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e){try{if(!e$())throw new te("No browser detected.");if("implicit"!==this.flowType||this._isImplicitGrantFlow()){if("pkce"==this.flowType&&!e)throw new tt("Not a valid PKCE flow url.")}else throw new te("Not a valid implicit grant flow url.");let t=eF(window.location.href);if(e){if(!t.code)throw new tt("No code detected.");let{data:e,error:r}=await this._exchangeCodeForSession(t.code);if(r)throw r;let i=new URL(window.location.href);return i.searchParams.delete("code"),window.history.replaceState(window.history.state,"",i.toString()),{data:{session:e.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new te(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});let{provider_token:r,provider_refresh_token:i,access_token:n,refresh_token:a,expires_in:s,expires_at:o,token_type:l}=t;if(!n||!s||!a||!l)throw new te("No session defined in URL");let u=Math.round(Date.now()/1e3),c=parseInt(s),d=u+c;o&&(d=parseInt(o));let h=d-u;1e3*h<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${c}s`);let f=d-c;u-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,d,u):u-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,d,u);let{data:p,error:v}=await this._getUser(n);if(v)throw v;let m={provider_token:r,provider_refresh_token:i,access_token:n,expires_in:c,expires_at:d,refresh_token:a,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:t.type},error:null}}catch(e){if(e8(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantFlow(){let e=eF(window.location.href);return!!(e$()&&(e.access_token||e.error_description))}async _isPKCEFlow(){let e=eF(window.location.href),t=await eV(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:i,error:n}=t;if(n)return{error:n};let a=null===(r=i.session)||void 0===r?void 0:r.access_token;if(a){let{error:t}=await this.admin.signOut(a,e);if(t&&!(e8(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await eG(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,i;try{let{data:{session:i},error:n}=t;if(n)throw n;await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(t){await (null===(i=this.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,i=null;"pkce"===this.flowType&&([r,i]=await e0(this.storage,this.storageKey,!0));try{return await tc(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(e8(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(e8(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:r,error:i}=await this._useSession(async t=>{var r,i,n,a,s;let{data:o,error:l}=t;if(l)throw l;let u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(i=e.options)||void 0===i?void 0:i.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:!0});return await tc(this.fetch,"GET",u,{headers:this.headers,jwt:null!==(s=null===(a=o.session)||void 0===a?void 0:a.access_token)&&void 0!==s?s:void 0})});if(i)throw i;return!e$()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(e8(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,i;let{data:n,error:a}=t;if(a)throw a;return await tc(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(i=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==i?i:void 0})})}catch(e){if(e8(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,i;let n=Date.now();return await (r=async r=>(r>0&&await eQ(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await tc(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:th})),i=(e,t)=>t&&ti(t)&&Date.now()+200*Math.pow(2,e)-n<3e4,new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{let t=await r(n);if(!i(n,null,t)){e(t);return}}catch(e){if(!i(n,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),e8(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),e$()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let r=await eV(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),null!==r&&await this._removeSession();return}let i=Math.round(Date.now()/1e3),n=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)<i+10;if(this._debug(t,`session has${n?"":" not"} expired with margin of 10s`),n){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),ti(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(t,"error",e),console.error(e);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new e6;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new eK;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new e6;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let i={session:t.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(e){if(this._debug(i,"error",e),e8(e)){let r={session:null,error:e};return ti(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,r=!0){let i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let i=[],n=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){i.push(e)}});if(await Promise.all(n),i.length>0){for(let e=0;e<i.length;e+=1)console.error(i[e]);throw i[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await eW(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await eG(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&e$()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let i=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),i<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tk)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!e$()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let i=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await e0(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});i.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);i.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:i,error:n}=t;return n?{data:null,error:n}:await tc(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token})})}catch(e){if(e8(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,i;let{data:n,error:a}=t;if(a)return{data:null,error:a};let s=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await tc(this.fetch,"POST",`${this.url}/factors`,{body:s,headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(i=null==o?void 0:o.totp)||void 0===i?void 0:i.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(e){if(e8(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:i,error:n}=t;if(n)return{data:null,error:n};let{data:a,error:s}=await tc(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return s?{data:null,error:s}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:s})})}catch(e){if(e8(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:i,error:n}=t;return n?{data:null,error:n}:await tc(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token})})}catch(e){if(e8(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],i=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),n=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:i,phone:n},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:i},error:n}=e;if(n)return{data:null,error:n};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let a=this._decodeJWT(i.access_token),s=null;a.aal&&(s=a.aal);let o=s;return(null!==(r=null===(t=i.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(o="aal2"),{data:{currentLevel:s,nextLevel:o,currentAuthenticationMethods:a.amr||[]},error:null}}))}}tA.nextInstanceID=0;var tR=tA;class tP extends tR{constructor(e){super(e)}}class tD{constructor(e,t,r){var i,n,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let s=e.replace(/\/$/,"");this.realtimeUrl=`${s}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${s}/auth/v1`,this.storageUrl=`${s}/storage/v1`,this.functionsUrl=`${s}/functions/v1`;let o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){let{db:r,auth:i,realtime:n,global:a}=e,{db:s,auth:o,realtime:l,global:u}=t,c={db:Object.assign(Object.assign({},s),r),auth:Object.assign(Object.assign({},o),i),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},u),a),accessToken:()=>{var e,t,r,i;return e=this,t=void 0,i=function*(){return""},new(r=void 0,r=Promise)(function(n,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,o)}l((i=i.apply(e,t||[])).next())})}};return e.accessToken?c.accessToken=e.accessToken:delete c.accessToken,c}(null!=r?r:{},{db:eA,realtime:eP,auth:Object.assign(Object.assign({},eR),{storageKey:o}),global:eO});this.storageKey=null!==(i=l.auth.storageKey)&&void 0!==i?i:"",this.headers=null!==(n=l.global.headers)&&void 0!==n?n:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(a=l.auth)&&void 0!==a?a:{},this.headers,l.global.fetch),this.fetch=eI(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},l.realtime)),this.rest=new u(`${s}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new l(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new eS(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,i,n,a;return r=this,i=void 0,n=void 0,a=function*(){if(this.accessToken)return yield this.accessToken();let{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null},new(n||(n=Promise))(function(e,t){function s(e){try{l(a.next(e))}catch(e){t(e)}}function o(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof n?r:new n(function(e){e(r)})).then(s,o)}l((a=a.apply(r,i||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,storageKey:n,flowType:a,lock:s,debug:o},l,u){var c;let d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new tP({url:this.authUrl,headers:Object.assign(Object.assign({},d),l),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,flowType:a,lock:s,debug:o,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new C(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.realtime.setAuth(null!=r?r:null),this.changedAccessToken=r):"SIGNED_OUT"===e&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}let tL=(e,t,r)=>new tD(e,t,r)},357:function(e,t,r){"use strict";var i,n;e.exports=(null==(i=r.g.process)?void 0:i.env)&&"object"==typeof(null==(n=r.g.process)?void 0:n.env)?r.g.process:r(8081)},6300:function(e){!function(){var t={675:function(e,t){"use strict";t.byteLength=function(e){var t=l(e),r=t[0],i=t[1];return(r+i)*3/4-i},t.toByteArray=function(e){var t,r,a=l(e),s=a[0],o=a[1],u=new n((s+o)*3/4-o),c=0,d=o>0?s-4:s;for(r=0;r<d;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;return 2===o&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,u[c++]=255&t),1===o&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t),u},t.fromByteArray=function(e){for(var t,i=e.length,n=i%3,a=[],s=0,o=i-n;s<o;s+=16383)a.push(function(e,t,i){for(var n,a=[],s=t;s<i;s+=3)a.push(r[(n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]))>>18&63]+r[n>>12&63]+r[n>>6&63]+r[63&n]);return a.join("")}(e,s,s+16383>o?o:s+16383));return 1===n?a.push(r[(t=e[i-1])>>2]+r[t<<4&63]+"=="):2===n&&a.push(r[(t=(e[i-2]<<8)+e[i-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),a.join("")};for(var r=[],i=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=a.length;s<o;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var i=r===t?0:4-r%4;return[r,i]}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},72:function(e,t,r){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var i=r(675),n=r(783),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function s(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return c(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw TypeError("Unknown encoding: "+t);var r=0|f(e,t),i=s(r),n=i.write(e,t);return n!==r&&(i=i.slice(0,n)),i}(e,t);if(ArrayBuffer.isView(e))return d(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(R(e,ArrayBuffer)||e&&R(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(R(e,SharedArrayBuffer)||e&&R(e.buffer,SharedArrayBuffer)))return function(e,t,r){var i;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),o.prototype),i}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return o.from(i,t,r);var n=function(e){if(o.isBuffer(e)){var t,r=0|h(e.length),i=s(r);return 0===i.length||e.copy(i,0,0,r),i}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?s(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return u(e),s(e<0?0:0|h(e))}function d(e){for(var t=e.length<0?0:0|h(e.length),r=s(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function h(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function f(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||R(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return S(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return O(e).length;default:if(n)return i?-1:S(e).length;t=(""+t).toLowerCase(),n=!0}}function p(e,t,r){var n,a,s=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",a=t;a<r;++a)n+=P[e[a]];return n}(this,t,r);case"utf8":case"utf-8":return _(this,t,r);case"ascii":return function(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}(this,t,r);case"latin1":case"binary":return function(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}(this,t,r);case"base64":return n=t,a=r,0===n&&a===this.length?i.fromByteArray(this):i.fromByteArray(this.slice(n,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var i=e.slice(t,r),n="",a=0;a<i.length;a+=2)n+=String.fromCharCode(i[a]+256*i[a+1]);return n}(this,t,r);default:if(s)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}function v(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function m(e,t,r,i,n){var a;if(0===e.length)return -1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(a=r=+r)!=a&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return -1;r=e.length-1}else if(r<0){if(!n)return -1;r=0}if("string"==typeof t&&(t=o.from(t,i)),o.isBuffer(t))return 0===t.length?-1:y(e,t,r,i,n);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,i,n);throw TypeError("val must be string, number or Buffer")}function y(e,t,r,i,n){var a,s=1,o=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return -1;s=2,o/=2,l/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n){var c=-1;for(a=r;a<o;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*s}else -1!==c&&(a-=a-c),c=-1}else for(r+l>o&&(r=o-l),a=r;a>=0;a--){for(var d=!0,h=0;h<l;h++)if(u(e,a+h)!==u(t,h)){d=!1;break}if(d)return a}return -1}function _(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var a,s,o,l,u=e[n],c=null,d=u>239?4:u>223?3:u>191?2:1;if(n+d<=r)switch(d){case 1:u<128&&(c=u);break;case 2:(192&(a=e[n+1]))==128&&(l=(31&u)<<6|63&a)>127&&(c=l);break;case 3:a=e[n+1],s=e[n+2],(192&a)==128&&(192&s)==128&&(l=(15&u)<<12|(63&a)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:a=e[n+1],s=e[n+2],o=e[n+3],(192&a)==128&&(192&s)==128&&(192&o)==128&&(l=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(c=l)}null===c?(c=65533,d=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),n+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",i=0;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return r}(i)}function g(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function b(e,t,r,i,n,a){if(!o.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<a)throw RangeError('"value" argument is out of bounds');if(r+i>e.length)throw RangeError("Index out of range")}function w(e,t,r,i,n,a){if(r+i>e.length||r<0)throw RangeError("Index out of range")}function T(e,t,r,i,a){return t=+t,r>>>=0,a||w(e,t,r,4,34028234663852886e22,-34028234663852886e22),n.write(e,t,r,i,23,4),r+4}function k(e,t,r,i,a){return t=+t,r>>>=0,a||w(e,t,r,8,17976931348623157e292,-17976931348623157e292),n.write(e,t,r,i,52,8),r+8}t.Buffer=o,t.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=2147483647,o.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,r){return(u(e),e<=0)?s(e):void 0!==t?"string"==typeof r?s(e).fill(t,r):s(e).fill(t):s(e)},o.allocUnsafe=function(e){return c(e)},o.allocUnsafeSlow=function(e){return c(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(R(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),R(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,i=t.length,n=0,a=Math.min(r,i);n<a;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,i=o.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var a=e[r];if(R(a,Uint8Array)&&(a=o.from(a)),!o.isBuffer(a))throw TypeError('"list" argument must be an Array of Buffers');a.copy(i,n),n+=a.length}return i},o.byteLength=f,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},o.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?_(this,0,e):p.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(o.prototype[a]=o.prototype.inspect),o.prototype.compare=function(e,t,r,i,n){if(R(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,n>>>=0,this===e)return 0;for(var a=n-i,s=r-t,l=Math.min(a,s),u=this.slice(i,n),c=e.slice(t,r),d=0;d<l;++d)if(u[d]!==c[d]){a=u[d],s=c[d];break}return a<s?-1:s<a?1:0},o.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},o.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var n,a,s,o,l,u,c,d,h,f,p,v,m=this.length-t;if((void 0===r||r>m)&&(r=m),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var y=!1;;)switch(i){case"hex":return function(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var a=t.length;i>a/2&&(i=a/2);for(var s=0;s<i;++s){var o=parseInt(t.substr(2*s,2),16);if(o!=o)break;e[r+s]=o}return s}(this,e,t,r);case"utf8":case"utf-8":return l=t,u=r,A(S(e,this.length-l),this,l,u);case"ascii":return c=t,d=r,A(x(e),this,c,d);case"latin1":case"binary":return n=this,a=e,s=t,o=r,A(x(a),n,s,o);case"base64":return h=t,f=r,A(O(e),this,h,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p=t,v=r,A(function(e,t){for(var r,i,n=[],a=0;a<e.length&&!((t-=2)<0);++a)i=(r=e.charCodeAt(a))>>8,n.push(r%256),n.push(i);return n}(e,this.length-p),this,p,v);default:if(y)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),y=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var i=this.subarray(e,t);return Object.setPrototypeOf(i,o.prototype),i},o.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||g(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i},o.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||g(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},o.prototype.readUInt8=function(e,t){return e>>>=0,t||g(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||g(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||g(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||g(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||g(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||g(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},o.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||g(e,t,this.length);for(var i=t,n=1,a=this[e+--i];i>0&&(n*=256);)a+=this[e+--i]*n;return a>=(n*=128)&&(a-=Math.pow(2,8*t)),a},o.prototype.readInt8=function(e,t){return(e>>>=0,t||g(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||g(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){e>>>=0,t||g(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||g(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||g(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return e>>>=0,t||g(e,4,this.length),n.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||g(e,4,this.length),n.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||g(e,8,this.length),n.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||g(e,8,this.length),n.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;b(this,e,t,r,n,0)}var a=1,s=0;for(this[t]=255&e;++s<r&&(a*=256);)this[t+s]=e/a&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;b(this,e,t,r,n,0)}var a=r-1,s=1;for(this[t+a]=255&e;--a>=0&&(s*=256);)this[t+a]=e/s&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);b(this,e,t,r,n-1,-n)}var a=0,s=1,o=0;for(this[t]=255&e;++a<r&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},o.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);b(this,e,t,r,n-1,-n)}var a=r-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||b(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeFloatLE=function(e,t,r){return T(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return T(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return k(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return k(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,i){if(!o.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n=i-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,i);else if(this===e&&r<t&&t<i)for(var a=n-1;a>=0;--a)e[a+t]=this[a+r];else Uint8Array.prototype.set.call(e,this.subarray(r,i),t);return n},o.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!o.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===e.length){var n,a=e.charCodeAt(0);("utf8"===i&&a<128||"latin1"===i)&&(e=a)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{var s=o.isBuffer(e)?e:o.from(e,i),l=s.length;if(0===l)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=s[n%l]}return this};var E=/[^+/0-9A-Za-z-_]/g;function S(e,t){t=t||1/0;for(var r,i=e.length,n=null,a=[],s=0;s<i;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!n){if(r>56319||s+1===i){(t-=3)>-1&&a.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),n=r;continue}r=(n-55296<<10|r-56320)+65536}else n&&(t-=3)>-1&&a.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return a}function x(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function O(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(E,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function A(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length)&&!(n>=e.length);++n)t[n+r]=e[n];return n}function R(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var P=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)t[i+n]=e[r]+e[n];return t}()},783:function(e,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(e,t,r,i,n){var a,s,o=8*n-i-1,l=(1<<o)-1,u=l>>1,c=-7,d=r?n-1:0,h=r?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-c)-1,f>>=-c,c+=o;c>0;a=256*a+e[t+d],d+=h,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=i;c>0;s=256*s+e[t+d],d+=h,c-=8);if(0===a)a=1-u;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,i),a-=u}return(f?-1:1)*s*Math.pow(2,a-i)},t.write=function(e,t,r,i,n,a){var s,o,l,u=8*a-n-1,c=(1<<u)-1,d=c>>1,h=23===n?5960464477539062e-23:0,f=i?0:a-1,p=i?1:-1,v=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(o=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(s++,l/=2),s+d>=c?(o=0,s=c):s+d>=1?(o=(t*l-1)*Math.pow(2,n),s+=d):(o=t*Math.pow(2,d-1)*Math.pow(2,n),s=0));n>=8;e[r+f]=255&o,f+=p,o/=256,n-=8);for(s=s<<n|o,u+=n;u>0;e[r+f]=255&s,f+=p,s/=256,u-=8);e[r+f-p]|=128*v}}},r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}},s=!0;try{t[e](a,a.exports,i),s=!1}finally{s&&delete r[e]}return a.exports}i.ab="//";var n=i(72);e.exports=n}()},8081:function(e){!function(){var t={229:function(e){var t,r,i,n=e.exports={};function a(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var l=[],u=!1,c=-1;function d(){u&&i&&(u=!1,i.length?l=i.concat(l):c=-1,l.length&&h())}function h(){if(!u){var e=o(d);u=!0;for(var t=l.length;t;){for(i=l,l=[];++c<t;)i&&i[c].run();c=-1,t=l.length}i=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new f(e,t)),1!==l.length||u||o(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}}},r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var a=r[e]={exports:{}},s=!0;try{t[e](a,a.exports,i),s=!1}finally{s&&delete r[e]}return a.exports}i.ab="//";var n=i(229);e.exports=n}()},9949:function(e,t,r){"use strict";var i=r(8877);function n(){}function a(){}a.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,a,s){if(s!==i){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:n};return r.PropTypes=r,r}},1448:function(e,t,r){e.exports=r(9949)()},8877:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3759:function(e,t,r){"use strict";r.d(t,{vx:function(){return tj},XE:function(){return tI},Ig:function(){return t$},cg:function(){return tA},Mw:function(){return tB},uI:function(){return tC},D7:function(){return tM},lo:function(){return tL},Kh:function(){return rn},UV:function(){return t3},kX:function(){return t0},PZ:function(){return tq},oJ:function(){return rk},cu:function(){return rs},yh:function(){return t9},Uo:function(){return ra},mn:function(){return t7},Ei:function(){return ru},X3:function(){return r$},by:function(){return rR},LS:function(){return rC},RD:function(){return rL},Nh:function(){return rl},wY:function(){return rP},Zj:function(){return rD},j2:function(){return rB},P7:function(){return t1},cx:function(){return rM},Lh:function(){return rS},QE:function(){return rO}});var i=Object.create,n=Object.defineProperty,a=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty,u=function(e,t){return function(){return e&&(t=e(e=0)),t}},c=function(e,t){return function(){return t||e((t={exports:{}}).exports,t),t.exports}},d=function(e,t,r,i){if(t&&"object"==typeof t||"function"==typeof t)for(var o,u=s(t),c=0,d=u.length;c<d;c++)o=u[c],l.call(e,o)||o===r||n(e,o,{get:(function(e){return t[e]}).bind(null,o),enumerable:!(i=a(t,o))||i.enumerable});return e},h=function(e,t,r){return r=null!=e?i(o(e)):{},d(!t&&e&&e.__esModule?r:n(r,"default",{value:e,enumerable:!0}),e)},f=c(function(e,t){var r;"undefined"!=typeof window?r=window:"undefined"!=typeof global?r=global:"undefined"!=typeof self?r=self:r={},t.exports=r});function p(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}var v=u(function(){}),m=c(function(e,t){var r;v(),r=function(){var e=function(){},t="undefined",r=("undefined"==typeof window?"undefined":p(window))!==t&&p(window.navigator)!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function n(e,t){var r=e[t];if("function"==typeof r.bind)return r.bind(e);try{return Function.prototype.bind.call(r,e)}catch(t){return function(){return Function.prototype.apply.apply(r,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(t,r){for(var n=0;n<i.length;n++){var a=i[n];this[a]=n<t?e:this.methodFactory(a,t,r)}this.log=this.debug}function o(e,r,i){return function(){("undefined"==typeof console?"undefined":p(console))!==t&&(s.call(this,r,i),this[e].apply(this,arguments))}}function l(i,s,l){var u;return"debug"===(u=i)&&(u="log"),("undefined"==typeof console?"undefined":p(console))!==t&&("trace"===u&&r?a:void 0!==console[u]?n(console,u):void 0!==console.log?n(console,"log"):e)||o.apply(this,arguments)}function u(e,r,n){var a,o=this;r=null==r?"WARN":r;var u="loglevel";function c(){var e;if(!(("undefined"==typeof window?"undefined":p(window))===t||!u)){try{e=window.localStorage[u]}catch(e){}if((void 0===e?"undefined":p(e))===t)try{var r=window.document.cookie,i=r.indexOf(encodeURIComponent(u)+"=");-1!==i&&(e=/^([^;]+)/.exec(r.slice(i))[1])}catch(e){}return void 0===o.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:(void 0===e?"undefined":p(e))==="symbol"&&(u=void 0),o.name=e,o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=n||l,o.getLevel=function(){return a},o.setLevel=function(r,n){if("string"==typeof r&&void 0!==o.levels[r.toUpperCase()]&&(r=o.levels[r.toUpperCase()]),"number"==typeof r&&r>=0&&r<=o.levels.SILENT){if(a=r,!1!==n&&function(e){var r=(i[e]||"silent").toUpperCase();if(!(("undefined"==typeof window?"undefined":p(window))===t||!u)){try{window.localStorage[u]=r;return}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+r+";"}catch(e){}}}(r),s.call(o,r,e),("undefined"==typeof console?"undefined":p(console))===t&&r<o.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+r},o.setDefaultLevel=function(e){r=e,c()||o.setLevel(e,!1)},o.resetLevel=function(){o.setLevel(r,!1),function(){if(!(("undefined"==typeof window?"undefined":p(window))===t||!u)){try{window.localStorage.removeItem(u);return}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},o.enableAll=function(e){o.setLevel(o.levels.TRACE,e)},o.disableAll=function(e){o.setLevel(o.levels.SILENT,e)};var d=c();null==d&&(d=r),o.setLevel(d,!1)}var c=new u,d={};c.getLogger=function(e){if((void 0===e?"undefined":p(e))!=="symbol"&&"string"!=typeof e||""===e)throw TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new u(e,c.getLevel(),c.methodFactory)),t};var h=("undefined"==typeof window?"undefined":p(window))!==t?window.log:void 0;return c.noConflict=function(){return("undefined"==typeof window?"undefined":p(window))!==t&&window.log===c&&(window.log=h),c},c.getLoggers=function(){return d},c.default=c,c},"function"==typeof define&&define.amd?define(r):"object"==typeof t&&t.exports?t.exports=r():e.log=r()});function y(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):y(e,t)}var _=u(function(){_()}),g=c(function(e){var t,r=Object.prototype.hasOwnProperty;function i(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function n(e){try{return encodeURIComponent(e)}catch(e){return null}}e.stringify=function(e,i){var a,s,o=[];for(s in"string"!=typeof(i=i||"")&&(i="?"),e)if(r.call(e,s)){if(!(a=e[s])&&(null===a||a===t||isNaN(a))&&(a=""),s=n(s),a=n(a),null===s||null===a)continue;o.push(s+"="+a)}return o.length?i+o.join("&"):""},e.parse=function(e){for(var t,r=/([^=?#&]+)=?([^&]*)/g,n={};t=r.exec(e);){var a=i(t[1]),s=i(t[2]);null===a||null===s||a in n||(n[a]=s)}return n}}),b=c(function(e,t){!function(r){var i=!1;if("function"==typeof define&&define.amd&&(define(r),i=!0),"object"==typeof e&&(t.exports=r(),i=!0),!i){var n=window.Cookies,a=window.Cookies=r();a.noConflict=function(){return window.Cookies=n,a}}}(function(){var e=function(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var i in r)t[i]=r[i]}return t};return function t(r){function i(t,n,a){var s;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(a=e({path:"/"},i.defaults,a)).expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*a.expires),a.expires=o}try{s=JSON.stringify(n),/^[\{\[]/.test(s)&&(n=s)}catch(e){}return n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",n,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}t||(s={});for(var l=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,c=0;c<l.length;c++){var d=l[c].split("="),h=d.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{var f=d[0].replace(u,decodeURIComponent);if(h=r.read?r.read(h,f):r(h,f)||h.replace(u,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(e){}if(t===f){s=h;break}t||(s[f]=h)}catch(e){}}return s}}return i.set=i,i.get=function(e){return i.call(i,e)},i.getJSON=function(){return i.apply({json:!0},[].slice.call(arguments))},i.defaults={},i.remove=function(t,r){i(t,"",e(r,{expires:-1}))},i.withConverter=t,i}(function(){})})}),w=c(function(e,t){var r=Array.prototype.slice;t.exports=function(e,t){for(("length"in e)||(e=[e]),e=r.call(e);e.length;){var i=e.shift(),n=t(i);if(n)return n;i.childNodes&&i.childNodes.length&&(e=r.call(i.childNodes).concat(e))}}}),T=c(function(e,t){function r(e,t){if(!y(this,r))return new r(e,t);this.data=e,this.nodeValue=e,this.length=e.length,this.ownerDocument=t||null}_(),t.exports=r,r.prototype.nodeType=8,r.prototype.nodeName="#comment",r.prototype.toString=function(){return"[object Comment]"}}),k=c(function(e,t){function r(e,t){if(!y(this,r))return new r(e);this.data=e||"",this.length=this.data.length,this.ownerDocument=t||null}_(),t.exports=r,r.prototype.type="DOMTextNode",r.prototype.nodeType=3,r.prototype.nodeName="#text",r.prototype.toString=function(){return this.data},r.prototype.replaceData=function(e,t,r){var i=this.data,n=i.substring(0,e),a=i.substring(e+t,i.length);this.data=n+r+a,this.length=this.data.length}}),E=c(function(e,t){t.exports=function(e){var t=this,r=e.type;e.target||(e.target=t),t.listeners||(t.listeners={});var i=t.listeners[r];if(i)return i.forEach(function(r){e.currentTarget=t,"function"==typeof r?r(e):r.handleEvent(e)});t.parentNode&&t.parentNode.dispatchEvent(e)}}),S=c(function(e,t){t.exports=function(e,t){this.listeners||(this.listeners={}),this.listeners[e]||(this.listeners[e]=[]),-1===this.listeners[e].indexOf(t)&&this.listeners[e].push(t)}}),x=c(function(e,t){t.exports=function(e,t){if(this.listeners&&this.listeners[e]){var r=this.listeners[e],i=r.indexOf(t);-1!==i&&r.splice(i,1)}}}),O=c(function(e,t){v(),t.exports=function e(t){switch(t.nodeType){case 3:return n(t.data);case 8:return"<!--"+t.data+"-->";default:var a,s;return a=[],s=t.tagName,"http://www.w3.org/1999/xhtml"===t.namespaceURI&&(s=s.toLowerCase()),a.push("<"+s+function(e){var t=[];for(var r in e)(function(e,t){var r=p(e[t]);return"style"===t&&Object.keys(e.style).length>0||e.hasOwnProperty(t)&&("string"===r||"boolean"===r||"number"===r)&&"nodeName"!==t&&"className"!==t&&"tagName"!==t&&"textContent"!==t&&"innerText"!==t&&"namespaceURI"!==t&&"innerHTML"!==t})(e,r)&&t.push({name:r,value:e[r]});for(var n in e._attributes)for(var a in e._attributes[n]){var s=e._attributes[n][a],o=(s.prefix?s.prefix+":":"")+a;t.push({name:o,value:s.value})}return e.className&&t.push({name:"class",value:e.className}),t.length?i(t):""}(t)+function(e){var t=e.dataset,r=[];for(var n in t)r.push({name:"data-"+n,value:t[n]});return r.length?i(r):""}(t)),r.indexOf(s)>-1?a.push(" />"):(a.push(">"),t.childNodes.length?a.push.apply(a,t.childNodes.map(e)):t.textContent||t.innerText?a.push(n(t.textContent||t.innerText)):t.innerHTML&&a.push(t.innerHTML),a.push("</"+s+">")),a.join("")}};var r=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function i(e){var t=[];return e.forEach(function(e){var r=e.name,i=e.value;"style"===r&&(i=function(e){if("string"==typeof e)return e;var t="";return Object.keys(e).forEach(function(r){var i=e[r];r=r.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),t+=r+":"+i+";"}),t}(i)),t.push(r+'="'+n(i).replace(/"/g,"&quot;")+'"')}),t.length?" "+t.join(" "):""}function n(e){var t="";return"string"==typeof e?t=e:e&&(t=e.toString()),t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}),A=c(function(e,t){_();var r=w(),i=E(),n=S(),a=x(),s=O(),o="http://www.w3.org/1999/xhtml";function l(e,t,r){if(!y(this,l))return new l(e);var i=void 0===r?o:r||null;this.tagName=i===o?String(e).toUpperCase():e,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=t||null,this.namespaceURI=i,this._attributes={},"INPUT"===this.tagName&&(this.type="text")}t.exports=l,l.prototype.type="DOMElement",l.prototype.nodeType=1,l.prototype.appendChild=function(e){return e.parentNode&&e.parentNode.removeChild(e),this.childNodes.push(e),e.parentNode=this,e},l.prototype.replaceChild=function(e,t){e.parentNode&&e.parentNode.removeChild(e);var r=this.childNodes.indexOf(t);return t.parentNode=null,this.childNodes[r]=e,e.parentNode=this,t},l.prototype.removeChild=function(e){var t=this.childNodes.indexOf(e);return this.childNodes.splice(t,1),e.parentNode=null,e},l.prototype.insertBefore=function(e,t){e.parentNode&&e.parentNode.removeChild(e);var r=null==t?-1:this.childNodes.indexOf(t);return r>-1?this.childNodes.splice(r,0,e):this.childNodes.push(e),e.parentNode=this,e},l.prototype.setAttributeNS=function(e,t,r){var i=null,n=t,a=t.indexOf(":");(a>-1&&(i=t.substr(0,a),n=t.substr(a+1)),"INPUT"===this.tagName&&"type"===t)?this.type=r:(this._attributes[e]||(this._attributes[e]={}))[n]={value:r,prefix:i}},l.prototype.getAttributeNS=function(e,t){var r=this._attributes[e],i=r&&r[t]&&r[t].value;return"INPUT"===this.tagName&&"type"===t?this.type:"string"!=typeof i?null:i},l.prototype.removeAttributeNS=function(e,t){var r=this._attributes[e];r&&delete r[t]},l.prototype.hasAttributeNS=function(e,t){var r=this._attributes[e];return!!r&&t in r},l.prototype.setAttribute=function(e,t){return this.setAttributeNS(null,e,t)},l.prototype.getAttribute=function(e){return this.getAttributeNS(null,e)},l.prototype.removeAttribute=function(e){return this.removeAttributeNS(null,e)},l.prototype.hasAttribute=function(e){return this.hasAttributeNS(null,e)},l.prototype.removeEventListener=a,l.prototype.addEventListener=n,l.prototype.dispatchEvent=i,l.prototype.focus=function(){},l.prototype.toString=function(){return s(this)},l.prototype.getElementsByClassName=function(e){var t=e.split(" "),i=[];return r(this,function(e){if(1===e.nodeType){var r=(e.className||"").split(" ");t.every(function(e){return -1!==r.indexOf(e)})&&i.push(e)}}),i},l.prototype.getElementsByTagName=function(e){e=e.toLowerCase();var t=[];return r(this.childNodes,function(r){1===r.nodeType&&("*"===e||r.tagName.toLowerCase()===e)&&t.push(r)}),t},l.prototype.contains=function(e){return r(this,function(t){return e===t})||!1}}),R=c(function(e,t){_();var r=A();function i(e){if(!y(this,i))return new i;this.childNodes=[],this.parentNode=null,this.ownerDocument=e||null}t.exports=i,i.prototype.type="DocumentFragment",i.prototype.nodeType=11,i.prototype.nodeName="#document-fragment",i.prototype.appendChild=r.prototype.appendChild,i.prototype.replaceChild=r.prototype.replaceChild,i.prototype.removeChild=r.prototype.removeChild,i.prototype.toString=function(){return this.childNodes.map(function(e){return String(e)}).join("")}}),P=c(function(e,t){function r(e){}t.exports=r,r.prototype.initEvent=function(e,t,r){this.type=e,this.bubbles=t,this.cancelable=r},r.prototype.preventDefault=function(){}}),D=c(function(e,t){_();var r=w(),i=T(),n=k(),a=A(),s=R(),o=P(),l=E(),u=S(),c=x();function d(){if(!y(this,d))return new d;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}t.exports=d;var h=d.prototype;h.createTextNode=function(e){return new n(e,this)},h.createElementNS=function(e,t){return new a(t,this,null===e?null:String(e))},h.createElement=function(e){return new a(e,this)},h.createDocumentFragment=function(){return new s(this)},h.createEvent=function(e){return new o(e)},h.createComment=function(e){return new i(e,this)},h.getElementById=function(e){return e=String(e),r(this.childNodes,function(t){if(String(t.id)===e)return t})||null},h.getElementsByClassName=a.prototype.getElementsByClassName,h.getElementsByTagName=a.prototype.getElementsByTagName,h.contains=a.prototype.contains,h.removeEventListener=c,h.addEventListener=u,h.dispatchEvent=l}),L=c(function(e,t){var r=D();t.exports=new r}),C=c(function(e,t){var r,i="undefined"!=typeof global?global:"undefined"!=typeof window?window:{},n=L();"undefined"!=typeof document?r=document:(r=i["__GLOBAL_DOCUMENT_CACHE@4"])||(r=i["__GLOBAL_DOCUMENT_CACHE@4"]=n),t.exports=r});function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,a=[],s=!0,o=!1;try{for(r=r.call(e);!(s=(i=r.next()).done)&&(a.push(i.value),!(t&&a.length===t));s=!0);}catch(e){o=!0,n=e}finally{try{s||null==r.return||r.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var N=h(f()),U=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},q=function(){return("000000"+(2176782336*Math.random()<<0).toString(36)).slice(-6)},$=function(e){var t;if(e&&void 0!==e.nodeName)return e.muxId||(e.muxId=q()),e.muxId;try{t=document.querySelector(e)}catch(e){}return t&&!t.muxId&&(t.muxId=e),(null==t?void 0:t.muxId)||e},B=function(e){e&&void 0!==e.nodeName?e=$(t=e):t=document.querySelector(e);var t,r=t&&t.nodeName?t.nodeName.toLowerCase():"";return[t,e,r]},M=h(m()),F=M.default.methodFactory;M.default.methodFactory=function(e,t,r){var i=F(e,t,r);return function(){for(var e=["[mux]"],t=0;t<arguments.length;t++)e.push(arguments[t]);i.apply(void 0,e)}},M.default.setLevel(M.default.getLevel());var H=M.default,z=h(f());function W(){return"1"===(z.default.doNotTrack||z.default.navigator&&z.default.navigator.doNotTrack)}var V=h(f()),G={now:function(){var e=V.default.performance,t=e&&e.timing,r=t&&t.navigationStart;return Math.round("number"==typeof r&&"function"==typeof e.now?r+e.now():Date.now())}};function K(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e,t){if(!y(e,t))throw TypeError("Cannot call a class as a function")}function Q(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Y(e,t,r){return t&&Q(e.prototype,t),r&&Q(e,r),e}function X(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}_(),v();var et=function(e){return er(e)[0]},er=function(e){if("string"!=typeof e||""===e)return["localhost"];var t,r=(e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/)||[])[4];return r&&(t=(r.match(/[^\.]+\.[^\.]+$/)||[])[0]),[r,t]},ei=h(f()),en={exists:function(){var e=ei.default.performance;return void 0!==(e&&e.timing)},domContentLoadedEventEnd:function(){var e=ei.default.performance,t=e&&e.timing;return t&&t.domContentLoadedEventEnd},navigationStart:function(){var e=ei.default.performance,t=e&&e.timing;return t&&t.navigationStart}};function ea(e,t,r){r=void 0===r?1:r,e[t]=e[t]||0,e[t]+=r}function es(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),i.forEach(function(t){X(e,t,r[t])})}return e}function eo(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);r.push.apply(r,i)}return r})(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}var el=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],eu=["x-cdn","content-type"].concat(el);function ec(e){var t={};return(e=e||"").trim().split(/[\r\n]+/).forEach(function(e){if(e){var r=e.split(": "),i=r.shift();i&&(eu.indexOf(i.toLowerCase())>=0||0===i.toLowerCase().indexOf("x-litix-"))&&(t[i]=r.join(": "))}}),t}function ed(e){if(e){var t=el.find(function(t){return void 0!==e[t]});return t?e[t]:void 0}}var eh=function(e){var t={};for(var r in e){var i=e[r];-1!==i["DATA-ID"].search("io.litix.data.")&&(t[i["DATA-ID"].replace("io.litix.data.","")]=i.VALUE)}return t},ef=function(e){if(!e)return{};var t=en.navigationStart(),r=e.loading,i=r?r.start:e.trequest,n=r?r.first:e.tfirst,a=r?r.end:e.tload;return{bytesLoaded:e.total,requestStart:Math.round(t+i),responseStart:Math.round(t+n),responseEnd:Math.round(t+a)}},ep=function(e){if(!(!e||"function"!=typeof e.getAllResponseHeaders))return ec(e.getAllResponseHeaders())},ev=function(e,t,r){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var i=arguments.length>4?arguments[4]:void 0,n=e.log,a=e.utils.secondsToMs,s=function(e){var t,r=parseInt(i.version);return 1===r&&null!==e.programDateTime&&(t=e.programDateTime),0===r&&null!==e.pdt&&(t=e.pdt),t};if(!en.exists()){n.warn("performance timing not supported. Not tracking HLS.js.");return}var o=function(r,i){return e.emit(t,r,i)},l=function(e,t){var r=t.levels,i=t.audioTracks,n=t.url,a=t.stats,s=t.networkDetails,l=t.sessionData,u={},c={};r.forEach(function(e,t){u[t]={width:e.width,height:e.height,bitrate:e.bitrate,attrs:e.attrs}}),i.forEach(function(e,t){c[t]={name:e.name,language:e.lang,bitrate:e.bitrate}});var d=ef(a),h=d.bytesLoaded,f=d.requestStart,p=d.responseStart,v=d.responseEnd;o("requestcompleted",eo(es({},eh(l)),{request_event_type:e,request_bytes_loaded:h,request_start:f,request_response_start:p,request_response_end:v,request_type:"manifest",request_hostname:et(n),request_response_headers:ep(s),request_rendition_lists:{media:u,audio:c,video:{}}}))};r.on(i.Events.MANIFEST_LOADED,l);var u=function(e,t){var r=t.details,i=t.level,n=t.networkDetails,l=ef(t.stats),u=l.bytesLoaded,c=l.requestStart,d=l.responseStart,h=l.responseEnd,f=r.fragments[r.fragments.length-1],p=s(f)+a(f.duration);o("requestcompleted",{request_event_type:e,request_bytes_loaded:u,request_start:c,request_response_start:d,request_response_end:h,request_current_level:i,request_type:"manifest",request_hostname:et(r.url),request_response_headers:ep(n),video_holdback:r.holdBack&&a(r.holdBack),video_part_holdback:r.partHoldBack&&a(r.partHoldBack),video_part_target_duration:r.partTarget&&a(r.partTarget),video_target_duration:r.targetduration&&a(r.targetduration),video_source_is_live:r.live,player_manifest_newest_program_time:isNaN(p)?void 0:p})};r.on(i.Events.LEVEL_LOADED,u);var c=function(e,t){var r=t.details,i=t.networkDetails,n=ef(t.stats);o("requestcompleted",{request_event_type:e,request_bytes_loaded:n.bytesLoaded,request_start:n.requestStart,request_response_start:n.responseStart,request_response_end:n.responseEnd,request_type:"manifest",request_hostname:et(r.url),request_response_headers:ep(i)})};r.on(i.Events.AUDIO_TRACK_LOADED,c);var d=function(e,t){var i=t.stats,n=t.networkDetails,a=t.frag,s=ef(i=i||a.stats),l=s.bytesLoaded,u=s.requestStart,c=s.responseStart,d=s.responseEnd,h=n?ep(n):void 0,f={request_event_type:e,request_bytes_loaded:l,request_start:u,request_response_start:c,request_response_end:d,request_hostname:n?et(n.responseURL):void 0,request_id:h?ed(h):void 0,request_response_headers:h,request_media_duration:a.duration,request_url:null==n?void 0:n.responseURL};"main"===a.type?(f.request_type="media",f.request_current_level=a.level,f.request_video_width=(r.levels[a.level]||{}).width,f.request_video_height=(r.levels[a.level]||{}).height,f.request_labeled_bitrate=(r.levels[a.level]||{}).bitrate):f.request_type=a.type,o("requestcompleted",f)};r.on(i.Events.FRAG_LOADED,d);var h=function(e,t){var r=t.frag,i=r.start;o("fragmentchange",{currentFragmentPDT:s(r),currentFragmentStart:a(i)})};r.on(i.Events.FRAG_CHANGED,h);var f=function(e,t){var r,n=t.type,a=t.details,s=t.response,l=t.fatal,u=t.frag,c=t.networkDetails,d=(null==u?void 0:u.url)||t.url||"",h=c?ep(c):void 0;(a===i.ErrorDetails.MANIFEST_LOAD_ERROR||a===i.ErrorDetails.MANIFEST_LOAD_TIMEOUT||a===i.ErrorDetails.FRAG_LOAD_ERROR||a===i.ErrorDetails.FRAG_LOAD_TIMEOUT||a===i.ErrorDetails.LEVEL_LOAD_ERROR||a===i.ErrorDetails.LEVEL_LOAD_TIMEOUT||a===i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||a===i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||a===i.ErrorDetails.SUBTITLE_LOAD_ERROR||a===i.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||a===i.ErrorDetails.KEY_LOAD_ERROR||a===i.ErrorDetails.KEY_LOAD_TIMEOUT)&&o("requestfailed",{request_error:a,request_url:d,request_hostname:et(d),request_id:h?ed(h):void 0,request_type:a===i.ErrorDetails.FRAG_LOAD_ERROR||a===i.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":a===i.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||a===i.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":a===i.ErrorDetails.SUBTITLE_LOAD_ERROR||a===i.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":a===i.ErrorDetails.KEY_LOAD_ERROR||a===i.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:null==s?void 0:s.code,request_error_text:null==s?void 0:s.text}),l&&o("error",{player_error_code:n,player_error_message:a,player_error_context:"".concat(d?"url: ".concat(d,"\n"):"")+"".concat(s&&(s.code||s.text)?"response: ".concat(s.code,", ").concat(s.text,"\n"):"")+"".concat(t.reason?"failure reason: ".concat(t.reason,"\n"):"")+"".concat(t.level?"level: ".concat(t.level,"\n"):"")+"".concat(t.parent?"parent stream controller: ".concat(t.parent,"\n"):"")+"".concat(t.buffer?"buffer length: ".concat(t.buffer,"\n"):"")+"".concat(t.error?"error: ".concat(t.error,"\n"):"")+"".concat(t.event?"event: ".concat(t.event,"\n"):"")+"".concat(t.err?"error message: ".concat(null===(r=t.err)||void 0===r?void 0:r.message,"\n"):"")})};r.on(i.Events.ERROR,f);var p=function(e,t){var r=t.frag,i=r&&r._url||"";o("requestcanceled",{request_event_type:e,request_url:i,request_type:"media",request_hostname:et(i)})};r.on(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,p);var v=function(e,t){var i=t.level,a=r.levels[i];if(a&&a.attrs&&a.attrs.BANDWIDTH){var s,l=a.attrs.BANDWIDTH,u=parseFloat(a.attrs["FRAME-RATE"]);isNaN(u)||(s=u),l?o("renditionchange",{video_source_fps:s,video_source_bitrate:l,video_source_width:a.width,video_source_height:a.height,video_source_rendition_name:a.name,video_source_codec:null==a?void 0:a.videoCodec}):n.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};r.on(i.Events.LEVEL_SWITCHED,v),r._stopMuxMonitor=function(){r.off(i.Events.MANIFEST_LOADED,l),r.off(i.Events.LEVEL_LOADED,u),r.off(i.Events.AUDIO_TRACK_LOADED,c),r.off(i.Events.FRAG_LOADED,d),r.off(i.Events.FRAG_CHANGED,h),r.off(i.Events.ERROR,f),r.off(i.Events.FRAG_LOAD_EMERGENCY_ABORTED,p),r.off(i.Events.LEVEL_SWITCHED,v),r.off(i.Events.DESTROYING,r._stopMuxMonitor),delete r._stopMuxMonitor},r.on(i.Events.DESTROYING,r._stopMuxMonitor)},em=function(e){e&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor()},ey=function(e,t){if(!e||!e.requestEndDate)return{};var r,i=et(e.url),n=e.url,a=e.bytesLoaded,s=new Date(e.requestStartDate).getTime(),o=new Date(e.firstByteDate).getTime(),l=new Date(e.requestEndDate).getTime(),u=isNaN(e.duration)?0:e.duration,c="function"==typeof t.getMetricsFor?t.getMetricsFor(e.mediaType).HttpList:t.getDashMetrics().getHttpRequests(e.mediaType);c.length>0&&(r=ec(c[c.length-1]._responseHeaders||""));var d=r?ed(r):void 0;return{requestStart:s,requestResponseStart:o,requestResponseEnd:l,requestBytesLoaded:a,requestResponseHeaders:r,requestMediaDuration:u,requestHostname:i,requestUrl:n,requestId:d}},e_=function(e,t){var r=t.getQualityFor(e),i=t.getCurrentTrackFor(e).bitrateList;return i?{currentLevel:r,renditionWidth:i[r].width||null,renditionHeight:i[r].height||null,renditionBitrate:i[r].bandwidth}:{}},eg=function(e){var t;return null===(t=e.match(/.*codecs\*?="(.*)"/))||void 0===t?void 0:t[1]},eb=function(e){try{var t,r;return null===(r=e.getVersion)||void 0===r||null===(t=r.call(e))||void 0===t?void 0:t.split(".").map(function(e){return parseInt(e)})[0]}catch(e){return!1}},ew=function(e,t,r){arguments.length>3&&void 0!==arguments[3]&&arguments[3];var i=e.log;if(!r||!r.on){i.warn("Invalid dash.js player reference. Monitoring blocked.");return}var n=eb(r),a=function(r,i){return e.emit(t,r,i)},s=function(e){var t=e.type,r=(e.data||{}).url;a("requestcompleted",{request_event_type:t,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:et(r),request_url:r})};r.on("manifestLoaded",s);var o={},l=function(e){if("function"!=typeof e.getRequests)return null;var t=e.getRequests({state:"executed"});return 0===t.length?null:t[t.length-1]},u=function(e){var t=e.type,i=e.chunk,n=e.request,s=(i||{}).mediaInfo||{},l=s.type,u=s.bitrateList,c={};(u=u||[]).forEach(function(e,t){c[t]={},c[t].width=e.width,c[t].height=e.height,c[t].bitrate=e.bandwidth,c[t].attrs={}}),"video"===l?o.video=c:"audio"===l?o.audio=c:o.media=c;var d=ey(n,r),h=d.requestStart,f=d.requestResponseStart,p=d.requestResponseEnd,v=d.requestResponseHeaders,m=d.requestMediaDuration,y=d.requestHostname,_=d.requestUrl;a("requestcompleted",{request_event_type:t,request_start:h,request_response_start:f,request_response_end:p,request_bytes_loaded:-1,request_type:l+"_init",request_response_headers:v,request_hostname:y,request_id:d.requestId,request_url:_,request_media_duration:m,request_rendition_lists:o})};n>=4?r.on("initFragmentLoaded",u):r.on("initFragmentLoaded",function(e){var t=e.type,r=e.fragmentModel,i=e.chunk;u({type:t,request:l(r),chunk:i})});var c=function(e){var t=e.type,i=e.chunk,n=e.request,s=i||{},o=s.mediaInfo,l=s.start,u=(o||{}).type,c=ey(n,r),d=c.requestStart,h=c.requestResponseStart,f=c.requestResponseEnd,p=c.requestBytesLoaded,v=c.requestResponseHeaders,m=c.requestMediaDuration,y=c.requestHostname,_=c.requestUrl,g=c.requestId,b=e_(u,r),w=b.currentLevel,T=b.renditionWidth,k=b.renditionHeight;a("requestcompleted",{request_event_type:t,request_start:d,request_response_start:h,request_response_end:f,request_bytes_loaded:p,request_type:u,request_response_headers:v,request_hostname:y,request_id:g,request_url:_,request_media_start_time:l,request_media_duration:m,request_current_level:w,request_labeled_bitrate:b.renditionBitrate,request_video_width:T,request_video_height:k})};n>=4?r.on("mediaFragmentLoaded",c):r.on("mediaFragmentLoaded",function(e){var t=e.type,r=e.fragmentModel,i=e.chunk;c({type:t,request:l(r),chunk:i})});var d={video:void 0,audio:void 0,totalBitrate:void 0},h=function(){if(d.video&&"number"==typeof d.video.bitrate){if(!(d.video.width&&d.video.height)){i.warn("have bitrate info for video but missing width/height");return}var e=d.video.bitrate;if(d.audio&&"number"==typeof d.audio.bitrate&&(e+=d.audio.bitrate),e!==d.totalBitrate)return d.totalBitrate=e,{video_source_bitrate:e,video_source_height:d.video.height,video_source_width:d.video.width,video_source_codec:eg(d.video.codec)}}},f=function(e,t,n){if("number"!=typeof e.newQuality){i.warn("missing evt.newQuality in qualityChangeRendered event",e);return}var s=e.mediaType;if("audio"===s||"video"===s){var o=r.getBitrateInfoListFor(s).find(function(t){return t.qualityIndex===e.newQuality});if(!(o&&"number"==typeof o.bitrate)){i.warn("missing bitrate info for ".concat(s));return}d[s]=eo(es({},o),{codec:r.getCurrentTrackFor(s).codec});var l=h();l&&a("renditionchange",l)}};r.on("qualityChangeRendered",f);var p=function(e){var t=e.request,r=e.mediaType;a("requestcanceled",{request_event_type:(t=t||{}).type+"_"+t.action,request_url:t.url,request_type:r,request_hostname:et(t.url)})};r.on("fragmentLoadingAbandoned",p);var v=function(e){var t,r,i=e.error,n=(null==i||null===(t=i.data)||void 0===t?void 0:t.request)||{},s=(null==i||null===(r=i.data)||void 0===r?void 0:r.response)||{};(null==i?void 0:i.code)===27&&a("requestfailed",{request_error:n.type+"_"+n.action,request_url:n.url,request_hostname:et(n.url),request_type:n.mediaType,request_error_code:s.status,request_error_text:s.statusText});var o="".concat(null!=n&&n.url?"url: ".concat(n.url,"\n"):"")+"".concat(null!=s&&s.status||null!=s&&s.statusText?"response: ".concat(null==s?void 0:s.status,", ").concat(null==s?void 0:s.statusText,"\n"):"");a("error",{player_error_code:null==i?void 0:i.code,player_error_message:null==i?void 0:i.message,player_error_context:o})};r.on("error",v),r._stopMuxMonitor=function(){r.off("manifestLoaded",s),r.off("initFragmentLoaded",u),r.off("mediaFragmentLoaded",c),r.off("qualityChangeRendered",f),r.off("error",v),r.off("fragmentLoadingAbandoned",p),delete r._stopMuxMonitor}},eT=function(e){e&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor()},ek=0,eE=function(){function e(){J(this,e),X(this,"_listeners",void 0)}return Y(e,[{key:"on",value:function(e,t,r){return t._eventEmitterGuid=t._eventEmitterGuid||++ek,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],r&&(t=t.bind(r)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var r=this._listeners&&this._listeners[e];r&&r.forEach(function(e,i){e._eventEmitterGuid===t._eventEmitterGuid&&r.splice(i,1)})}},{key:"one",value:function(e,t,r){var i=this;t._eventEmitterGuid=t._eventEmitterGuid||++ek;var n=function(){i.off(e,n),t.apply(r||this,arguments)};n._eventEmitterGuid=t._eventEmitterGuid,this.on(e,n)}},{key:"emit",value:function(e,t){var r=this;if(this._listeners){t=t||{};var i=this._listeners["before*"]||[],n=this._listeners[e]||[],a=this._listeners["after"+e]||[],s=function(t,i){(t=t.slice()).forEach(function(t){t.call(r,{type:e},i)})};s(i,t),s(n,t),s(a,t)}}}]),e}(),eS=h(f()),ex=function(){function e(t){var r=this;J(this,e),X(this,"_playbackHeartbeatInterval",void 0),X(this,"_playheadShouldBeProgressing",void 0),X(this,"pm",void 0),this.pm=t,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,t.on("playing",function(){r._playheadShouldBeProgressing=!0}),t.on("play",this._startPlaybackHeartbeatInterval.bind(this)),t.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),t.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),t.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),t.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),t.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),t.on("seeked",function(){t.data.player_is_paused?r._stopPlaybackHeartbeatInterval():r._startPlaybackHeartbeatInterval()}),t.on("timeupdate",function(){null!==r._playbackHeartbeatInterval&&t.emit("playbackheartbeat")}),t.on("devicesleep",function(e,i){null!==r._playbackHeartbeatInterval&&(eS.default.clearInterval(r._playbackHeartbeatInterval),t.emit("playbackheartbeatend",{viewer_time:i.viewer_time}),r._playbackHeartbeatInterval=null)})}return Y(e,[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;null===this._playbackHeartbeatInterval&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=eS.default.setInterval(function(){e.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,null!==this._playbackHeartbeatInterval&&(eS.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),e}(),eO=function e(t){var r=this;J(this,e),X(this,"viewErrored",void 0),t.on("viewinit",function(){r.viewErrored=!1}),t.on("error",function(e,i){try{var n=t.errorTranslator({player_error_code:i.player_error_code,player_error_message:i.player_error_message,player_error_context:i.player_error_context,player_error_severity:i.player_error_severity,player_error_business_exception:i.player_error_business_exception});n&&(t.data.player_error_code=n.player_error_code||i.player_error_code,t.data.player_error_message=n.player_error_message||i.player_error_message,t.data.player_error_context=n.player_error_context||i.player_error_context,t.data.player_error_severity=n.player_error_severity||i.player_error_severity,t.data.player_error_business_exception=n.player_error_business_exception||i.player_error_business_exception,r.viewErrored=!0)}catch(e){t.mux.log.warn("Exception in error translator callback.",e),r.viewErrored=!0}}),t.on("aftererror",function(){var e,r,i,n,a;null===(e=t.data)||void 0===e||delete e.player_error_code,null===(r=t.data)||void 0===r||delete r.player_error_message,null===(i=t.data)||void 0===i||delete i.player_error_context,null===(n=t.data)||void 0===n||delete n.player_error_severity,null===(a=t.data)||void 0===a||delete a.player_error_business_exception})},eA=function(){function e(t){J(this,e),X(this,"_watchTimeTrackerLastCheckedTime",void 0),X(this,"pm",void 0),this.pm=t,this._watchTimeTrackerLastCheckedTime=null,t.on("playbackheartbeat",this._updateWatchTime.bind(this)),t.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return Y(e,[{key:"_updateWatchTime",value:function(e,t){var r=t.viewer_time;null===this._watchTimeTrackerLastCheckedTime&&(this._watchTimeTrackerLastCheckedTime=r),ea(this.pm.data,"view_watch_time",r-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=r}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}]),e}(),eR=function(){function e(t){var r=this;J(this,e),X(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),X(this,"_lastTime",void 0),X(this,"_isAdPlaying",void 0),X(this,"_callbackUpdatePlaybackTime",void 0),X(this,"pm",void 0),this.pm=t,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=G.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null;var i=this._startPlaybackTimeTracking.bind(this);t.on("playing",i),t.on("adplaying",i),t.on("seeked",i);var n=this._stopPlaybackTimeTracking.bind(this);t.on("playbackheartbeatend",n),t.on("seeking",n),t.on("adplaying",function(){r._isAdPlaying=!0}),t.on("adended",function(){r._isAdPlaying=!1}),t.on("adpause",function(){r._isAdPlaying=!1}),t.on("adbreakstart",function(){r._isAdPlaying=!1}),t.on("adbreakend",function(){r._isAdPlaying=!1}),t.on("adplay",function(){r._isAdPlaying=!1}),t.on("viewinit",function(){r._playbackTimeTrackerLastPlayheadPosition=-1,r._lastTime=G.now(),r._isAdPlaying=!1,r._callbackUpdatePlaybackTime=null})}return Y(e,[{key:"_startPlaybackTimeTracking",value:function(){null===this._callbackUpdatePlaybackTime&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time,t=G.now(),r=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?r=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(r=t-this._lastTime),r>0&&r<=1e3&&ea(this.pm.data,"view_content_playback_time",r),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}}]),e}(),eP=function(){function e(t){J(this,e),X(this,"pm",void 0),this.pm=t;var r=this._updatePlayheadTime.bind(this);t.on("playbackheartbeat",r),t.on("playbackheartbeatend",r),t.on("timeupdate",r),t.on("destroy",function(){t.off("timeupdate",r)})}return Y(e,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=void 0===this.pm.data.view_max_playhead_position?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var r=this,i=function(){r.pm.currentFragmentPDT&&r.pm.currentFragmentStart&&(r.pm.data.player_program_time=r.pm.currentFragmentPDT+r.pm.data.player_playhead_time-r.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,i(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var n=this.pm.getPlayheadTime();void 0!==n&&(this.pm.data.player_playhead_time=n,i(),this._updateMaxPlayheadPosition())}}}]),e}(),eD=function e(t){if(J(this,e),!t.disableRebufferTracking){var r,i=function(e,t){n(t),r=void 0},n=function(e){if(r){var i=e.viewer_time-r;ea(t.data,"view_rebuffer_duration",i),r=e.viewer_time,t.data.view_rebuffer_duration>3e5&&(t.emit("viewend"),t.send("viewend"),t.mux.log.warn("Ending view after rebuffering for longer than ".concat(3e5,"ms, future events will be ignored unless a programchange or videochange occurs.")))}t.data.view_watch_time>=0&&t.data.view_rebuffer_count>0&&(t.data.view_rebuffer_frequency=t.data.view_rebuffer_count/t.data.view_watch_time,t.data.view_rebuffer_percentage=t.data.view_rebuffer_duration/t.data.view_watch_time)};t.on("playbackheartbeat",function(e,t){return n(t)}),t.on("rebufferstart",function(e,n){r||(ea(t.data,"view_rebuffer_count",1),r=n.viewer_time,t.one("rebufferend",i))}),t.on("viewinit",function(){r=void 0,t.off("rebufferend",i)})}},eL=function(){function e(t){var r=this;J(this,e),X(this,"_lastCheckedTime",void 0),X(this,"_lastPlayheadTime",void 0),X(this,"_lastPlayheadTimeUpdatedTime",void 0),X(this,"_rebuffering",void 0),X(this,"pm",void 0),this.pm=t,t.disableRebufferTracking||t.disablePlayheadRebufferTracking||(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,t.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),t.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),t.on("seeking",function(){r._cleanupRebufferTracker(null,{viewer_time:G.now()})}))}return Y(e,[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing){this._cleanupRebufferTracker(e,t);return}if(null===this._lastCheckedTime){this._prepareRebufferTrackerState(t.viewer_time);return}if(this._lastPlayheadTime!==this.pm.data.player_playhead_time){this._cleanupRebufferTracker(e,t,!0);return}var r=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.sustainedRebufferThreshold&&r>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(null===this._lastCheckedTime)return;var i=this.pm.data.player_playhead_time-this._lastPlayheadTime,n=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.minimumRebufferDuration&&i>0&&n-i>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+n-i}))}r?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}]),e}(),eC=function(){function e(t){var r=this;J(this,e),X(this,"NAVIGATION_START",void 0),X(this,"pm",void 0),this.pm=t,t.on("viewinit",function(){var e=t.data,i=e.view_id;if(!e.view_program_changed){var n=function(e,n){var a=n.viewer_time;"playing"===e.type&&void 0===t.data.view_time_to_first_frame?r.calculateTimeToFirstFrame(a||G.now(),i):"adplaying"===e.type&&(void 0===t.data.view_time_to_first_frame||r._inPrerollPosition())&&r.calculateTimeToFirstFrame(a||G.now(),i)};t.one("playing",n),t.one("adplaying",n),t.one("viewend",function(){t.off("playing",n),t.off("adplaying",n)})}})}return Y(e,[{key:"_inPrerollPosition",value:function(){return void 0===this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}]),e}(),eI=function e(t){var r=this;J(this,e),X(this,"_lastPlayerHeight",void 0),X(this,"_lastPlayerWidth",void 0),X(this,"_lastPlayheadPosition",void 0),X(this,"_lastSourceHeight",void 0),X(this,"_lastSourceWidth",void 0),t.on("viewinit",function(){r._lastPlayheadPosition=-1}),["pause","rebufferstart","seeking","error","adbreakstart","hb"].forEach(function(e){t.on(e,function(){if(r._lastPlayheadPosition>=0&&t.data.player_playhead_time>=0&&r._lastPlayerWidth>=0&&r._lastSourceWidth>0&&r._lastPlayerHeight>=0&&r._lastSourceHeight>0){var e=t.data.player_playhead_time-r._lastPlayheadPosition;if(e<0){r._lastPlayheadPosition=-1;return}var i=Math.min(r._lastPlayerWidth/r._lastSourceWidth,r._lastPlayerHeight/r._lastSourceHeight),n=Math.max(0,i-1),a=Math.max(0,1-i);t.data.view_max_upscale_percentage=Math.max(t.data.view_max_upscale_percentage||0,n),t.data.view_max_downscale_percentage=Math.max(t.data.view_max_downscale_percentage||0,a),ea(t.data,"view_total_content_playback_time",e),ea(t.data,"view_total_upscaling",n*e),ea(t.data,"view_total_downscaling",a*e)}r._lastPlayheadPosition=-1})}),["playing","hb"].forEach(function(e){t.on(e,function(){r._lastPlayheadPosition=t.data.player_playhead_time,r._lastPlayerWidth=t.data.player_width,r._lastPlayerHeight=t.data.player_height,r._lastSourceWidth=t.data.video_source_width,r._lastSourceHeight=t.data.video_source_height})})},ej=function e(t){var r=this;J(this,e),X(this,"isSeeking",void 0),this.isSeeking=!1;var i=-1,n=function(){var e=G.now(),n=(t.data.viewer_time||e)-(i||e);ea(t.data,"view_seek_duration",n),t.data.view_max_seek_time=Math.max(t.data.view_max_seek_time||0,n),r.isSeeking=!1,i=-1};t.on("seeking",function(e,a){if(Object.assign(t.data,a),r.isSeeking&&a.viewer_time-i<=2e3){i=a.viewer_time;return}r.isSeeking&&n(),r.isSeeking=!0,i=a.viewer_time,ea(t.data,"view_seek_count",1),t.send("seeking")}),t.on("seeked",function(){n()}),t.on("viewend",function(){r.isSeeking&&(n(),t.send("seeked")),r.isSeeking=!1,i=-1})},eN=function(e,t){e.push(t),e.sort(function(e,t){return e.viewer_time-t.viewer_time})},eU=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],eq=function(){function e(t){var r=this;J(this,e),X(this,"_adHasPlayed",void 0),X(this,"_adRequests",void 0),X(this,"_adResponses",void 0),X(this,"_currentAdRequestNumber",void 0),X(this,"_currentAdResponseNumber",void 0),X(this,"_prerollPlayTime",void 0),X(this,"_wouldBeNewAdPlay",void 0),X(this,"isAdBreak",void 0),X(this,"pm",void 0),this.pm=t,t.on("viewinit",function(){r.isAdBreak=!1,r._currentAdRequestNumber=0,r._currentAdResponseNumber=0,r._adRequests=[],r._adResponses=[],r._adHasPlayed=!1,r._wouldBeNewAdPlay=!0,r._prerollPlayTime=void 0}),eU.forEach(function(e){return t.on(e,r._updateAdData.bind(r))});var i=function(){r.isAdBreak=!1};t.on("adbreakstart",function(){r.isAdBreak=!0}),t.on("play",i),t.on("playing",i),t.on("viewend",i),t.on("adrequest",function(e,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+r._currentAdRequestNumber++},i),eN(r._adRequests,i),ea(t.data,"view_ad_request_count"),r.inPrerollPosition()&&(t.data.view_preroll_requested=!0,r._adHasPlayed||ea(t.data,"view_preroll_request_count"))}),t.on("adresponse",function(e,i){i=Object.assign({ad_request_id:"generatedAdRequestId"+r._currentAdResponseNumber++},i),eN(r._adResponses,i);var n=r.findAdRequest(i.ad_request_id);n&&ea(t.data,"view_ad_request_time",Math.max(0,i.viewer_time-n.viewer_time))}),t.on("adplay",function(e,i){r._adHasPlayed=!0,r._wouldBeNewAdPlay&&(r._wouldBeNewAdPlay=!1,ea(t.data,"view_ad_played_count")),r.inPrerollPosition()&&!t.data.view_preroll_played&&(t.data.view_preroll_played=!0,r._adRequests.length>0&&(t.data.view_preroll_request_time=Math.max(0,i.viewer_time-r._adRequests[0].viewer_time)),t.data.view_start&&(t.data.view_startup_preroll_request_time=Math.max(0,i.viewer_time-t.data.view_start)),r._prerollPlayTime=i.viewer_time)}),t.on("adplaying",function(e,i){r.inPrerollPosition()&&void 0===t.data.view_preroll_load_time&&void 0!==r._prerollPlayTime&&(t.data.view_preroll_load_time=i.viewer_time-r._prerollPlayTime,t.data.view_startup_preroll_load_time=i.viewer_time-r._prerollPlayTime)}),t.on("adclicked",function(e,i){r._wouldBeNewAdPlay||ea(t.data,"view_ad_clicked_count")}),t.on("adskipped",function(e,i){r._wouldBeNewAdPlay||ea(t.data,"view_ad_skipped_count")}),t.on("adended",function(){r._wouldBeNewAdPlay=!0}),t.on("aderror",function(){r._wouldBeNewAdPlay=!0})}return Y(e,[{key:"inPrerollPosition",value:function(){return void 0===this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var r=j(er(t.ad_tag_url),2),i=r[0],n=r[1];this.pm.data.view_preroll_ad_tag_domain=n,this.pm.data.view_preroll_ad_tag_hostname=i}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var a=j(er(t.ad_asset_url),2),s=a[0],o=a[1];this.pm.data.view_preroll_ad_asset_domain=o,this.pm.data.view_preroll_ad_asset_hostname=s}}this.pm.data.ad_asset_url=null==t?void 0:t.ad_asset_url,this.pm.data.ad_tag_url=null==t?void 0:t.ad_tag_url,this.pm.data.ad_creative_id=null==t?void 0:t.ad_creative_id,this.pm.data.ad_id=null==t?void 0:t.ad_id,this.pm.data.ad_universal_id=null==t?void 0:t.ad_universal_id}}]),e}(),e$=h(f()),eB=function e(t){J(this,e);var r,i,n=function(){t.disableRebufferTracking||(ea(t.data,"view_waiting_rebuffer_count",1),r=G.now(),i=e$.default.setInterval(function(){if(r){var e=G.now();ea(t.data,"view_waiting_rebuffer_duration",e-r),r=e}},250))},a=function(){t.disableRebufferTracking||r&&(ea(t.data,"view_waiting_rebuffer_duration",G.now()-r),r=!1,e$.default.clearInterval(i))},s=!1,o=function(){s=!0},l=function(){s=!1,a()};t.on("waiting",function(){s&&n()}),t.on("playing",function(){a(),o()}),t.on("pause",l),t.on("seeking",l)},eM=function e(t){var r=this;J(this,e),X(this,"lastWallClockTime",void 0);var i=function(){r.lastWallClockTime=G.now(),t.on("before*",n)},n=function(e){var i=G.now(),n=r.lastWallClockTime;r.lastWallClockTime=i,i-n>3e4&&(t.emit("devicesleep",{viewer_time:n}),Object.assign(t.data,{viewer_time:n}),t.send("devicesleep"),t.emit("devicewake",{viewer_time:i}),Object.assign(t.data,{viewer_time:i}),t.send("devicewake"))};t.one("playbackheartbeat",i),t.on("playbackheartbeatend",function(){t.off("before*",n),t.one("playbackheartbeat",i)})},eF=h(f()),eH=h(g()),ez=h(b()),eW="muxData",eV=function(){var e;try{e=eH.default.parse(ez.default.get(eW)||"")}catch(t){e={}}return e},eG=function(e){try{ez.default.set(eW,eH.default.stringify(e),{expires:365})}catch(e){}},eK=function(){var e=eV();return e.mux_viewer_id=e.mux_viewer_id||U(),e.msn=e.msn||Math.random(),eG(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}},eJ=function(){var e=eV(),t=G.now();return e.session_start&&(e.sst=e.session_start,delete e.session_start),e.session_id&&(e.sid=e.session_id,delete e.session_id),e.session_expires&&(e.sex=e.session_expires,delete e.session_expires),(!e.sex||e.sex<t)&&(e.sid=U(),e.sst=t),e.sex=t+15e5,eG(e),{session_id:e.sid,session_start:e.sst,session_expires:e.sex}},eQ=h(f()),eY=function(){var e;switch(eX()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},eX=function(){var e=eQ.default.navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};eY.getConnectionFromAPI=eX;var eZ=e1({a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"}),e0=e1({ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ck:"clicked",cl:"canceled",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",pt:"part",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"});function e1(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t}function e2(e){var t={},r={};return Object.keys(e).forEach(function(i){var n=!1;if(e.hasOwnProperty(i)&&void 0!==e[i]){var a=i.split("_"),s=a[0],o=eZ[s];o||(H.info("Data key word `"+a[0]+"` not expected in "+i),o=s+"_"),a.splice(1).forEach(function(e){"url"===e&&(n=!0),e0[e]?o+=e0[e]:Number(e)&&Math.floor(Number(e))===Number(e)?o+=e:(H.info("Data key word `"+e+"` not expected in "+i),o+="_"+e+"_")}),n?r[o]=e[i]:t[o]=e[i]}}),Object.assign(t,r)}var e8=h(f()),e4={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},e5=["hb","requestcompleted","requestfailed","requestcanceled"],e3=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._beaconUrl=e||"https://img.litix.io",this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},e4,t)};e3.prototype.queueEvent=function(e,t){var r=Object.assign({},t);return(this._eventQueue.length<=this._options.maxQueueLength||"eventrateexceeded"===e)&&(this._eventQueue.push(r),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength)},e3.prototype.flushEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e&&1===this._eventQueue.length){this._eventQueue.pop();return}this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending()},e3.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.destroyed=!0,e?this._clearBeaconQueue():this.flushEvents(),e8.default.clearTimeout(this._sendTimeout)},e3.prototype._clearBeaconQueue=function(){var e=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,t=this._eventQueue.slice(e);e>0&&Object.assign(t[t.length-1],e2({mux_view_message:"event queue truncated"}));var r=this._createPayload(t);e6(this._beaconUrl,r,!0,function(){})},e3.prototype._sendBeaconQueue=function(){var e=this;if(!this._postInFlight){var t=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var r=this._createPayload(t),i=G.now();e6(this._beaconUrl,r,!1,function(r,n){n?(e._eventQueue=t.concat(e._eventQueue),e._failureCount+=1,H.info("Error sending beacon: "+n)):e._failureCount=0,e._roundTripTime=G.now()-i,e._postInFlight=!1})}},e3.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var e=Math.pow(2,this._failureCount-1);return(1+(e*=Math.random()))*this._options.baseTimeBetweenBeacons},e3.prototype._startBeaconSending=function(){var e=this;e8.default.clearTimeout(this._sendTimeout),this.destroyed||(this._sendTimeout=e8.default.setTimeout(function(){e._eventQueue.length&&e._sendBeaconQueue(),e._startBeaconSending()},this._getNextBeaconTime()))},e3.prototype._createPayload=function(e){var t=this,r={transmission_timestamp:Math.round(G.now())};this._roundTripTime&&(r.rtt_ms=Math.round(this._roundTripTime));var i,n,a,s=function(){a=(i=JSON.stringify({metadata:r,events:n||e})).length/1024},o=function(){return a<=t._options.maxPayloadKBSize};return s(),o()||(H.info("Payload size is too big ("+a+" kb). Removing unnecessary events."),n=e.filter(function(e){return -1===e5.indexOf(e.e)}),s()),o()||(H.info("Payload size still too big ("+a+" kb). Cropping fields.."),n.forEach(function(e){for(var t in e){var r=e[t];"string"==typeof r&&r.length>51200&&(e[t]=r.substring(0,51200))}}),s()),i};var e6=function(e,t,r,i){if(r&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(e,t)){i();return}if(e8.default.fetch){e8.default.fetch(e,{method:"POST",body:t,headers:{"Content-Type":"text/plain"},keepalive:t.length<=57344}).then(function(e){return i(null,e.ok?null:"Error")}).catch(function(e){return i(null,e)});return}if(e8.default.XMLHttpRequest){var n=new e8.default.XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState)return i(null,200!==n.status?"error":void 0)},n.open("POST",e),n.setRequestHeader("Content-Type","text/plain"),n.send(t);return}i()},e7=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception"],e9=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],te=["ad_id","ad_creative_id","ad_universal_id"],tt=["viewstart","error","ended","viewend"],tr=function(){function e(t,r){var i,n,a,s,o,l,u,c,d,h,f,p,v,m,y,_,g,b,w,T=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};J(this,e),X(this,"mux",void 0),X(this,"envKey",void 0),X(this,"options",void 0),X(this,"eventQueue",void 0),X(this,"sampleRate",void 0),X(this,"disableCookies",void 0),X(this,"respectDoNotTrack",void 0),X(this,"previousBeaconData",void 0),X(this,"lastEventTime",void 0),X(this,"rateLimited",void 0),X(this,"pageLevelData",void 0),X(this,"viewerData",void 0),this.mux=t,this.envKey=r,this.options=T,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new e3((i=this.envKey,a=(n=this.options).beaconCollectionDomain,s=n.beaconDomain,a?"https://"+a:(i=i||"inferred").match(/^[a-z0-9]+$/)?"https://"+i+"."+(s||"litix.io"):"https://img.litix.io/a.gif")),this.sampleRate=null!==(g=this.options.sampleRate)&&void 0!==g?g:1,this.disableCookies=null!==(b=this.options.disableCookies)&&void 0!==b&&b,this.respectDoNotTrack=null!==(w=this.options.respectDoNotTrack)&&void 0!==w&&w,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:null===(o=this.options.platform)||void 0===o?void 0:o.name,viewer_application_version:null===(l=this.options.platform)||void 0===l?void 0:l.version,viewer_application_engine:null===(u=this.options.platform)||void 0===u?void 0:u.layout,viewer_device_name:null===(c=this.options.platform)||void 0===c?void 0:c.product,viewer_device_category:"",viewer_device_manufacturer:null===(d=this.options.platform)||void 0===d?void 0:d.manufacturer,viewer_os_family:null===(f=this.options.platform)||void 0===f||null===(h=f.os)||void 0===h?void 0:h.family,viewer_os_architecture:null===(v=this.options.platform)||void 0===v||null===(p=v.os)||void 0===p?void 0:p.architecture,viewer_os_version:null===(y=this.options.platform)||void 0===y||null===(m=y.os)||void 0===m?void 0:m.version,viewer_connection_type:eY(),page_url:null===eF.default||void 0===eF.default||null===(_=eF.default.location)||void 0===_?void 0:_.href},this.viewerData=this.disableCookies?{}:eK()}return Y(e,[{key:"send",value:function(e,t){if(!(!e||!(null!=t&&t.view_id))){if(this.respectDoNotTrack&&W())return H.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||"object"!=typeof t)return H.error("A data object was expected in send() but was not provided");var r=this.disableCookies?{}:eJ(),i=eo(es({},this.pageLevelData,t,r,this.viewerData),{event:e,env_key:this.envKey});i.user_id&&(i.viewer_user_id=i.user_id,delete i.user_id);var n,a=(null!==(n=i.mux_sample_number)&&void 0!==n?n:0)>=this.sampleRate,s=e2(this._deduplicateBeaconData(e,i));if(this.lastEventTime=this.mux.utils.now(),a)return H.info("Not sending event due to sample rate restriction",e,i,s);if(this.envKey||H.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,i,s),!this.rateLimited){if(H.info("Sending event",e,i,s),this.rateLimited=!this.eventQueue.queueEvent(e,s),this.mux.WINDOW_UNLOADING&&"viewend"===e)this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&"hb"===e?this.eventQueue.flushEvents(!0):tt.indexOf(e)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return i.event="eventrateexceeded",s=e2(i),this.eventQueue.queueEvent(i.event,s),H.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var r=this,i={},n=t.view_id;if("-1"===n||"viewstart"===e||"viewend"===e||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=6e5)i=es({},t),n&&(this.previousBeaconData=i),n&&"viewend"===e&&(this.previousBeaconData=null);else{var a=0===e.indexOf("request");Object.entries(t).forEach(function(t){var n=j(t,2),s=n[0],o=n[1];r.previousBeaconData&&(o!==r.previousBeaconData[s]||e7.indexOf(s)>-1||r.objectHasChanged(a,s,o,r.previousBeaconData[s])||r.eventRequiresKey(e,s))&&(i[s]=o,r.previousBeaconData[s]=o)})}return i}},{key:"objectHasChanged",value:function(e,t,r,i){return!!e&&0===t.indexOf("request_")&&("request_response_headers"===t||"object"!=typeof r||"object"!=typeof i||Object.keys(r||{}).length!==Object.keys(i||{}).length)}},{key:"eventRequiresKey",value:function(e,t){return!!("renditionchange"===e&&0===t.indexOf("video_source_")||te.includes(t)&&e9.includes(e))}}]),e}(),ti=function e(t){J(this,e);var r=0,i=0,n=0,a=0,s=0,o=0,l=0;t.on("requestcompleted",function(e,o){var l,u,c=o.request_start,d=o.request_response_start,h=o.request_response_end,f=o.request_bytes_loaded;if(a++,d?(l=d-(null!=c?c:0),u=(null!=h?h:0)-d):u=(null!=h?h:0)-(null!=c?c:0),u>0&&f&&f>0){var p=f/u*8e3;s++,i+=f,n+=u,t.data.view_min_request_throughput=Math.min(t.data.view_min_request_throughput||1/0,p),t.data.view_average_request_throughput=i/n*8e3,t.data.view_request_count=a,l>0&&(r+=l,t.data.view_max_request_latency=Math.max(t.data.view_max_request_latency||0,l),t.data.view_average_request_latency=r/s)}}),t.on("requestfailed",function(e,r){a++,o++,t.data.view_request_count=a,t.data.view_request_failed_count=o}),t.on("requestcanceled",function(e,r){a++,l++,t.data.view_request_count=a,t.data.view_request_canceled_count=l})},tn=function e(t){var r=this;J(this,e),X(this,"_lastEventTime",void 0),t.on("before*",function(e,i){var n=i.viewer_time,a=G.now(),s=r._lastEventTime;if(r._lastEventTime=a,s&&a-s>36e5){var o=Object.keys(t.data).reduce(function(e,r){return 0===r.indexOf("video_")?Object.assign(e,X({},r,t.data[r])):e},{});t.mux.log.info("Received event after at least an hour inactivity, creating a new view"),t.emit("viewinit",Object.assign({viewer_time:n},o)),t.playbackHeartbeat._playheadShouldBeProgressing&&"play"!==e.type&&"adbreakstart"!==e.type&&(t.emit("play",{viewer_time:n}),"playing"!==e.type&&t.emit("playing",{viewer_time:n}))}})},ta=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],ts=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(i,e);var t,r=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,r=ee(i);return e=t?Reflect.construct(r,arguments,ee(this).constructor):r.apply(this,arguments),e&&("object"===p(e)||"function"==typeof e)?e:K(this)});function i(e,t,n){J(this,i),X(K(a=r.call(this)),"DOM_CONTENT_LOADED_EVENT_END",void 0),X(K(a),"NAVIGATION_START",void 0),X(K(a),"_destroyed",void 0),X(K(a),"_heartBeatTimeout",void 0),X(K(a),"adTracker",void 0),X(K(a),"dashjs",void 0),X(K(a),"data",void 0),X(K(a),"disablePlayheadRebufferTracking",void 0),X(K(a),"disableRebufferTracking",void 0),X(K(a),"errorTracker",void 0),X(K(a),"errorTranslator",void 0),X(K(a),"getAdData",void 0),X(K(a),"getPlayheadTime",void 0),X(K(a),"getStateData",void 0),X(K(a),"hlsjs",void 0),X(K(a),"id",void 0),X(K(a),"longResumeTracker",void 0),X(K(a),"minimumRebufferDuration",void 0),X(K(a),"mux",void 0),X(K(a),"oldEmit",void 0),X(K(a),"playbackEventDispatcher",void 0),X(K(a),"playbackHeartbeat",void 0),X(K(a),"playbackHeartbeatTime",void 0),X(K(a),"playheadTime",void 0),X(K(a),"seekingTracker",void 0),X(K(a),"sustainedRebufferThreshold",void 0),X(K(a),"watchTimeTracker",void 0),X(K(a),"currentFragmentPDT",void 0),X(K(a),"currentFragmentStart",void 0),a.DOM_CONTENT_LOADED_EVENT_END=en.domContentLoadedEventEnd(),a.NAVIGATION_START=en.navigationStart(),a.mux=e,a.id=t,null!=n&&n.beaconDomain&&a.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),(n=Object.assign({debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(e){return e}},n)).data=n.data||{},n.data.property_key&&(n.data.env_key=n.data.property_key,delete n.data.property_key),H.setLevel(n.debug?"debug":"warn"),a.getPlayheadTime=n.getPlayheadTime,a.getStateData=n.getStateData||function(){return{}},a.getAdData=n.getAdData||function(){},a.minimumRebufferDuration=n.minimumRebufferDuration,a.sustainedRebufferThreshold=n.sustainedRebufferThreshold,a.playbackHeartbeatTime=n.playbackHeartbeatTime,a.disableRebufferTracking=n.disableRebufferTracking,a.disableRebufferTracking&&a.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),a.disablePlayheadRebufferTracking=n.disablePlayheadRebufferTracking,a.errorTranslator=n.errorTranslator,a.playbackEventDispatcher=new tr(e,n.data.env_key,n),a.data={player_instance_id:U(),mux_sample_rate:n.sampleRate,beacon_domain:n.beaconCollectionDomain||n.beaconDomain},a.data.view_sequence_number=1,a.data.player_sequence_number=1,a.oldEmit=a.emit,a.emit=function(e,t){t=Object.assign({viewer_time:this.mux.utils.now()},t),this.oldEmit(e,t)};var a,s=(function(){void 0===this.data.view_start&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}).bind(K(a));a.on("viewinit",function(e,t){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,t),this._initializeViewData(),this.one("play",s),this.one("adbreakstart",s)});var o=(function(e){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",e)}).bind(K(a));if(a.on("videochange",function(e,t){o(t)}),a.on("programchange",function(e,t){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),o(Object.assign(t,{view_program_changed:!0})),s(),this.emit("play"),this.emit("playing")}),a.on("fragmentchange",function(e,t){this.currentFragmentPDT=t.currentFragmentPDT,this.currentFragmentStart=t.currentFragmentStart}),a.on("destroy",a.destroy),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&"function"==typeof window.removeEventListener){var l=function(){var e=void 0!==a.data.view_start;a.mux.WINDOW_HIDDEN="hidden"===document.visibilityState,e&&a.mux.WINDOW_HIDDEN&&(a.data.player_is_paused||a.emit("hb"))};window.addEventListener("visibilitychange",l,!1);var u=function(e){e.persisted||a.destroy()};window.addEventListener("pagehide",u,!1),a.on("destroy",function(){window.removeEventListener("visibilitychange",l),window.removeEventListener("pagehide",u)})}return a.on("playerready",function(e,t){Object.assign(this.data,t)}),ta.forEach(function(e){a.on(e,function(t,r){0!==e.indexOf("ad")&&this._updateStateData(),Object.assign(this.data,r),this._sanitizeData()}),a.on("after"+e,function(){("error"!==e||this.errorTracker.viewErrored)&&this.send(e)})}),a.on("viewend",function(e,t){Object.assign(a.data,t)}),a.one("playerready",function(e){var t=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=t-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time}),a.longResumeTracker=new tn(K(a)),a.errorTracker=new eO(K(a)),new eM(K(a)),a.seekingTracker=new ej(K(a)),a.playheadTime=new eP(K(a)),a.playbackHeartbeat=new ex(K(a)),new eI(K(a)),a.watchTimeTracker=new eA(K(a)),new eR(K(a)),a.adTracker=new eq(K(a)),new eL(K(a)),new eD(K(a)),new eC(K(a)),new eB(K(a)),new ti(K(a)),n.hlsjs&&a.addHLSJS(n),n.dashjs&&a.addDashJS(n),a.emit("viewinit",n.data),a}return Y(i,[{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,void 0!==this.data.view_start&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(e){if(this.data.view_id){var t=Object.assign({},this.data);if(void 0===t.video_source_is_live&&(t.player_source_duration===1/0||t.video_source_duration===1/0?t.video_source_is_live=!0:(t.player_source_duration>0||t.video_source_duration>0)&&(t.video_source_is_live=!1)),t.video_source_is_live||["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"].forEach(function(e){t[e]=void 0}),t.video_source_url=t.video_source_url||t.player_source_url,t.video_source_url){var r=j(er(t.video_source_url),2),i=r[0],n=r[1];t.video_source_domain=n,t.video_source_hostname=i}delete t.ad_request_id,this.playbackEventDispatcher.send(e,t),this.data.view_sequence_number++,this.data.player_sequence_number++,this._restartHeartBeat(),"viewend"===e&&delete this.data.view_id}}},{key:"_updateStateData",value:function(){Object.assign(this.data,this.getStateData()),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var e=this;["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"].forEach(function(t){var r=parseInt(e.data[t],10);e.data[t]=isNaN(r)?void 0:r}),["player_source_url","video_source_url"].forEach(function(t){if(e.data[t]){var r=e.data[t].toLowerCase();(0===r.indexOf("data:")||0===r.indexOf("blob:"))&&(e.data[t]="MSE style URL")}})}},{key:"_resetVideoData",value:function(){var e=this;Object.keys(this.data).forEach(function(t){0===t.indexOf("video_")&&delete e.data[t]})}},{key:"_resetViewData",value:function(){var e=this;Object.keys(this.data).forEach(function(t){0===t.indexOf("view_")&&delete e.data[t]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var e=this,t=this.data.view_id=U(),r=function(){t===e.data.view_id&&ea(e.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",r):r()}},{key:"_restartHeartBeat",value:function(){var e=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout(function(){e.data.player_is_paused||e.emit("hb")},1e4)}},{key:"addHLSJS",value:function(e){if(!e.hlsjs){this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.");return}if(this.hlsjs){this.mux.log.warn("An instance of HLS.js is already being monitored for this player.");return}this.hlsjs=e.hlsjs,ev(this.mux,this.id,e.hlsjs,{},e.Hls||window.Hls)}},{key:"removeHLSJS",value:function(){this.hlsjs&&(em(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(e){if(!e.dashjs){this.mux.log.warn("You must pass a valid dashjs instance in order to track it.");return}if(this.dashjs){this.mux.log.warn("An instance of Dash.js is already being monitored for this player.");return}this.dashjs=e.dashjs,ew(this.mux,this.id,e.dashjs)}},{key:"removeDashJS",value:function(){this.dashjs&&(eT(this.dashjs),this.dashjs=void 0)}}]),i}(eE);v();var to,tl=h(C()),tu=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],tc={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"},td=h(f());td.default&&td.default.WeakMap&&(to=new WeakMap);var th={TARGET_DURATION:"#EXT-X-TARGETDURATION",PART_INF:"#EXT-X-PART-INF",SERVER_CONTROL:"#EXT-X-SERVER-CONTROL",INF:"#EXTINF",PROGRAM_DATE_TIME:"#EXT-X-PROGRAM-DATE-TIME",VERSION:"#EXT-X-VERSION",SESSION_DATA:"#EXT-X-SESSION-DATA"},tf=function(e){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(e),this.manifest};tf.prototype.process=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.processLine(this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},tf.prototype.processLine=function(e){var t=e.indexOf(":"),r=tb(e,t),i=r[0],n=2===r.length?tm(r[1]):void 0;if("#"!==i[0])this.currentUri.uri=i,this.manifest.segments.push(this.currentUri),!this.manifest.targetDuration||"duration"in this.currentUri||(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(i){case th.TARGET_DURATION:if(!isFinite(n)||n<0)return;this.manifest.targetDuration=n,this.setHoldBack();break;case th.PART_INF:tp(this.manifest,r),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break;case th.SERVER_CONTROL:tp(this.manifest,r),this.setHoldBack();break;case th.INF:0===n?this.currentUri.duration=.01:n>0&&(this.currentUri.duration=n);break;case th.PROGRAM_DATE_TIME:var a=new Date(n);this.manifest.dateTimeString||(this.manifest.dateTimeString=n,this.manifest.dateTimeObject=a),this.currentUri.dateTimeString=n,this.currentUri.dateTimeObject=a;break;case th.VERSION:tp(this.manifest,r);break;case th.SESSION_DATA:var s=eh(tw(r[1]));Object.assign(this.manifest.sessionData,s)}},tf.prototype.setHoldBack=function(){var e=this.manifest,t=e.serverControl,r=e.targetDuration,i=e.partTargetDuration;if(t){var n="holdBack",a="partHoldBack",s=r&&3*r,o=i&&2*i;r&&!t.hasOwnProperty(n)&&(t[n]=s),s&&t[n]<s&&(t[n]=s),i&&!t.hasOwnProperty(a)&&(t[a]=3*i),i&&t[a]<o&&(t[a]=o)}};var tp=function(e,t){var r,i=tv(t[0].replace("#EXT-X-",""));tg(t[1])?(r={},r=Object.assign(t_(t[1]),r)):r=tm(t[1]),e[i]=r},tv=function(e){return e.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},tm=function(e){if("yes"===e.toLowerCase()||"no"===e.toLowerCase())return"yes"===e.toLowerCase();var t=-1!==e.indexOf(":")?e:parseFloat(e);return isNaN(t)?e:t},ty=function(e){var t={},r=e.split("=");return r.length>1&&(t[tv(r[0])]=tm(r[1])),t},t_=function(e){for(var t=e.split(","),r={},i=0;t.length>i;i++)r=Object.assign(ty(t[i]),r);return r},tg=function(e){return e.indexOf("=")>-1},tb=function(e,t){return -1===t?[e]:[e.substring(0,t),e.substring(t+1)]},tw=function(e){var t={};if(e){var r=e.search(",");return[e.slice(0,r),e.slice(r+1)].forEach(function(e,r){for(var i=e.replace(/['"]+/g,"").split("="),n=0;n<i.length;n++)"DATA-ID"===i[n]&&(t["DATA-ID"]=i[1-n]),"VALUE"===i[n]&&(t.VALUE=i[1-n])}),{data:t}}},tT={safeCall:function(e,t,r,i){var n=i;if(e&&"function"==typeof e[t])try{n=e[t].apply(e,r)}catch(e){H.info("safeCall error",e)}return n},safeIncrement:ea,getComputedStyle:function(e,t){var r;return e&&t&&td.default&&"function"==typeof td.default.getComputedStyle?(to&&to.has(e)&&(r=to.get(e)),r||(r=td.default.getComputedStyle(e,null),to&&to.set(e,r)),r.getPropertyValue(t)):""},secondsToMs:function(e){return Math.floor(1e3*e)},assign:Object.assign,headersStringToObject:ec,cdnHeadersToRequestId:ed,extractHostnameAndDomain:er,extractHostname:et,manifestParser:tf,generateShortID:q,generateUUID:U,now:G.now},tk={},tE=function(e){var t=arguments;"string"==typeof e?tE.hasOwnProperty(e)?N.default.setTimeout(function(){t=Array.prototype.splice.call(t,1),tE[e].apply(null,t)},0):H.warn("`"+e+"` is an unknown task"):"function"==typeof e?N.default.setTimeout(function(){e(tE)},0):H.warn("`"+e+"` is invalid.")},tS={loaded:G.now(),NAME:"mux-embed",VERSION:"5.2.1",API_VERSION:"2.1",PLAYER_TRACKED:!1,monitor:function(e,t){return function(e,t,r){var i=j(B(t),3),n=i[0],a=i[1],s=i[2],o=e.log,l=e.utils.getComputedStyle,u=e.utils.secondsToMs;if(!n)return o.error("No element was found with the `"+a+"` query selector.");if("video"!==s&&"audio"!==s)return o.error("The element of `"+a+"` was not a media element.");n.mux&&(n.mux.destroy(),delete n.mux,o.warn("Already monitoring this video element, replacing existing event listeners")),(r=Object.assign({automaticErrorTracking:!0},r)).data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:e.VERSION},r.data),r.getPlayheadTime=function(){return u(n.currentTime)},r.getStateData=function(){var e,t=this.hlsjs&&this.hlsjs.url,i=this.dashjs&&p("function"===this.dashjs.getSource)&&this.dashjs.getSource(),a={player_is_paused:n.paused,player_playhead_time:u(n.currentTime),player_width:parseInt(l(n,"width")),player_height:parseInt(l(n,"height")),player_autoplay_on:n.autoplay,player_preload_on:n.preload,player_language_code:n.lang,player_is_fullscreen:tl.default&&!!(tl.default.fullscreenElement||tl.default.webkitFullscreenElement||tl.default.mozFullScreenElement||tl.default.msFullscreenElement),video_poster_url:n.poster,video_source_url:t||i||n.currentSrc,video_source_duration:u(n.duration),video_source_height:n.videoHeight,video_source_width:n.videoWidth,view_dropped_frame_count:null==n||null===(e=n.getVideoPlaybackQuality)||void 0===e?void 0:e.call(n).droppedVideoFrames},s=r.getPlayheadTime();if(n.getStartDate&&s>0){var o=n.getStartDate();if(o&&"function"==typeof o.getTime&&o.getTime()){var c=o.getTime();if(a.player_program_time=c+s,n.seekable.length>0){var d=c+n.seekable.end(n.seekable.length-1);a.player_live_edge_program_time=d}}}return a},n.mux=n.mux||{},n.mux.deleted=!1,n.mux.emit=function(t,r){e.emit(a,t,r)};var c=function(){o.error("The monitor for this video element has already been destroyed.")};n.mux.destroy=function(){Object.keys(n.mux.listeners).forEach(function(e){n.removeEventListener(e,n.mux.listeners[e],!1)}),delete n.mux.listeners,n.mux.destroy=c,n.mux.swapElement=c,n.mux.emit=c,n.mux.addHLSJS=c,n.mux.addDashJS=c,n.mux.removeHLSJS=c,n.mux.removeDashJS=c,n.mux.deleted=!0,e.emit(a,"destroy")},n.mux.swapElement=function(t){var r=j(B(t),3),i=r[0],a=r[1],s=r[2];return i?"video"!==s&&"audio"!==s?e.log.error("The element of `"+a+"` was not a media element."):void(i.muxId=n.muxId,delete n.muxId,i.mux=i.mux||{},i.mux.listeners=Object.assign({},n.mux.listeners),delete n.mux.listeners,Object.keys(i.mux.listeners).forEach(function(e){n.removeEventListener(e,i.mux.listeners[e],!1),i.addEventListener(e,i.mux.listeners[e],!1)}),i.mux.swapElement=n.mux.swapElement,i.mux.destroy=n.mux.destroy,delete n.mux,n=i):e.log.error("No element was found with the `"+a+"` query selector.")},n.mux.addHLSJS=function(t){e.addHLSJS(a,t)},n.mux.addDashJS=function(t){e.addDashJS(a,t)},n.mux.removeHLSJS=function(){e.removeHLSJS(a)},n.mux.removeDashJS=function(){e.removeDashJS(a)},e.init(a,r),e.emit(a,"playerready"),n.paused||(e.emit(a,"play"),n.readyState>2&&e.emit(a,"playing")),n.mux.listeners={},tu.forEach(function(t){("error"!==t||r.automaticErrorTracking)&&(n.mux.listeners[t]=function(){var r={};if("error"===t){if(!n.error||1===n.error.code)return;r.player_error_code=n.error.code,r.player_error_message=tc[n.error.code]||n.error.message}e.emit(a,t,r)},n.addEventListener(t,n.mux.listeners[t],!1))})}(tE,e,t)},destroyMonitor:function(e){var t=j(B(e),1)[0];t&&t.mux&&"function"==typeof t.mux.destroy?t.mux.destroy():H.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(e,t){var r=$(e);tk[r]?tk[r].addHLSJS(t):H.error("A monitor for `"+r+"` has not been initialized.")},addDashJS:function(e,t){var r=$(e);tk[r]?tk[r].addDashJS(t):H.error("A monitor for `"+r+"` has not been initialized.")},removeHLSJS:function(e){var t=$(e);tk[t]?tk[t].removeHLSJS():H.error("A monitor for `"+t+"` has not been initialized.")},removeDashJS:function(e){var t=$(e);tk[t]?tk[t].removeDashJS():H.error("A monitor for `"+t+"` has not been initialized.")},init:function(e,t){W()&&t&&t.respectDoNotTrack&&H.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var r=$(e);tk[r]=new ts(tE,r,t)},emit:function(e,t,r){var i=$(e);tk[i]?(tk[i].emit(t,r),"destroy"===t&&delete tk[i]):H.error("A monitor for `"+i+"` has not been initialized.")},checkDoNotTrack:W,log:H,utils:tT,events:{PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled"},WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(tE,tS),void 0!==N.default&&"function"==typeof N.default.addEventListener&&N.default.addEventListener("pagehide",function(e){e.persisted||(tE.WINDOW_UNLOADING=!0)},!1);var tx=r(3915).ZP,tO=class e extends Error{constructor(t,r=e.MEDIA_ERR_CUSTOM,i,n){var a;super(t),this.name="MediaError",this.code=r,this.context=n,this.fatal=null!=i?i:r>=e.MEDIA_ERR_NETWORK&&r<=e.MEDIA_ERR_ENCRYPTED,this.message||(this.message=null!=(a=e.defaultMessages[this.code])?a:"")}};tO.MEDIA_ERR_ABORTED=1,tO.MEDIA_ERR_NETWORK=2,tO.MEDIA_ERR_DECODE=3,tO.MEDIA_ERR_SRC_NOT_SUPPORTED=4,tO.MEDIA_ERR_ENCRYPTED=5,tO.MEDIA_ERR_CUSTOM=100,tO.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail.",3:"A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.",4:"An unsupported error occurred. The server or network failed, or your browser does not support this format.",5:"The media is encrypted and there are no keys to decrypt it."};var tA=tO,tR=e=>null==e,tP=(e,t)=>!tR(t)&&e in t,tD={ANY:"any",MUTED:"muted"},tL={ON_DEMAND:"on-demand",LIVE:"live",UNKNOWN:"unknown"},tC={MSE:"mse",NATIVE:"native"},tI={HEADER:"header",QUERY:"query",NONE:"none"},tj=Object.values(tI),tN={M3U8:"application/vnd.apple.mpegurl",MP4:"video/mp4"},tU={HLS:tN.M3U8},tq=(Object.keys(tU),[...Object.values(tN),"hls","HLS"]),t$={upTo720p:"720p",upTo1080p:"1080p",upTo1440p:"1440p",upTo2160p:"2160p"},tB={noLessThan480p:"480p",noLessThan540p:"540p",noLessThan720p:"720p",noLessThan1080p:"1080p",noLessThan1440p:"1440p",noLessThan2160p:"2160p"},tM={DESCENDING:"desc"},tF=(e,t,r,i,n=e)=>{n.addEventListener(t,r,i),e.addEventListener("teardown",()=>{n.removeEventListener(t,r)},{once:!0})},tH=e=>{let t=e.indexOf("?");return t<0?[e]:[e.slice(0,t),e.slice(t)]},tz=e=>{let t=e.type;if(t){let e=t.toUpperCase();return tP(e,tU)?tU[e]:t}let{src:r}=e;return r?tG(r):""},tW=e=>"VOD"===e?tL.ON_DEMAND:tL.LIVE,tV=e=>"EVENT"===e?Number.POSITIVE_INFINITY:"VOD"===e?Number.NaN:0,tG=e=>{let t="";try{t=new URL(e).pathname}catch{console.error("invalid url")}let r=t.lastIndexOf(".");if(r<0)return"";let i=t.slice(r+1).toUpperCase();return tP(i,tN)?tN[i]:""},tK=Object.values(tD),tJ=e=>"boolean"==typeof e||"string"==typeof e&&tK.includes(e),tQ=(e,t,r)=>{let{autoplay:i}=e,n=!1,a=!1,s=tJ(i)?i:!!i,o=()=>{n||tF(t,"playing",()=>{n=!0},{once:!0})};if(o(),tF(t,"loadstart",()=>{n=!1,o(),tY(t,s)},{once:!0}),tF(t,"loadstart",()=>{r||(a=e.streamType&&e.streamType!==tL.UNKNOWN?e.streamType===tL.LIVE:!Number.isFinite(t.duration)),tY(t,s)},{once:!0}),r&&r.once(tx.Events.LEVEL_LOADED,(t,r)=>{var i;a=e.streamType&&e.streamType!==tL.UNKNOWN?e.streamType===tL.LIVE:null!=(i=r.details.live)&&i}),!s){let i=()=>{!a||Number.isFinite(e.startTime)||(null!=r&&r.liveSyncPosition?t.currentTime=r.liveSyncPosition:Number.isFinite(t.seekable.end(0))&&(t.currentTime=t.seekable.end(0)))};r&&tF(t,"play",()=>{"metadata"===t.preload?r.once(tx.Events.LEVEL_UPDATED,i):i()},{once:!0})}return e=>{n||tY(t,s=tJ(e)?e:!!e)}},tY=(e,t)=>{if(!t)return;let r=e.muted,i=()=>e.muted=r;switch(t){case tD.ANY:e.play().catch(()=>{e.muted=!0,e.play().catch(i)});break;case tD.MUTED:e.muted=!0,e.play().catch(i);break;default:e.play().catch(()=>{})}},tX=({preload:e,src:t},r,i)=>{let n=e=>{null!=e&&["","none","metadata","auto"].includes(e)?r.setAttribute("preload",e):r.removeAttribute("preload")};if(!i)return n(e),n;let a=!1,s=!1,o=i.config.maxBufferLength,l=i.config.maxBufferSize,u=e=>{n(e);let t=null!=e?e:r.preload;s||"none"===t||("metadata"===t?(i.config.maxBufferLength=1,i.config.maxBufferSize=1):(i.config.maxBufferLength=o,i.config.maxBufferSize=l),c())},c=()=>{!a&&t&&(a=!0,i.loadSource(t))};return tF(r,"play",()=>{s=!0,i.config.maxBufferLength=o,i.config.maxBufferSize=l,c()},{once:!0}),u(e),u},tZ=e=>"time"in e?e.time:e.startTime;function t0(e,t,r,i,n){let a=document.createElement("track");return a.kind=t,a.label=r,i&&(a.srclang=i),n&&(a.id=n),a.track.mode=["subtitles","captions"].includes(t)?"disabled":"hidden",a.setAttribute("data-removeondestroy",""),e.append(a),a.track}function t1(e,t){let r=Array.prototype.find.call(e.querySelectorAll("track"),e=>e.track===t);null==r||r.remove()}function t2(e,t,r){var i;return null==(i=Array.from(e.querySelectorAll("track")).find(e=>e.track.label===t&&e.track.kind===r))?void 0:i.track}async function t8(e,t,r,i){let n=t2(e,r,i);return n||((n=t0(e,i,r)).mode="hidden",await new Promise(e=>setTimeout(()=>e(void 0),0))),"hidden"!==n.mode&&(n.mode="hidden"),[...t].sort((e,t)=>tZ(t)-tZ(e)).forEach(t=>{var r,a;let s=t.value,o=tZ(t);if("endTime"in t&&null!=t.endTime)null==n||n.addCue(new VTTCue(o,t.endTime,"chapters"===i?s:JSON.stringify(null!=s?s:null)));else{let t=Array.prototype.findIndex.call(null==n?void 0:n.cues,e=>e.startTime>=o),l=null==(r=null==n?void 0:n.cues)?void 0:r[t],u=l?l.startTime:Number.isFinite(e.duration)?e.duration:Number.MAX_SAFE_INTEGER,c=null==(a=null==n?void 0:n.cues)?void 0:a[t-1];c&&(c.endTime=o),null==n||n.addCue(new VTTCue(o,u,"chapters"===i?s:JSON.stringify(null!=s?s:null)))}}),e.textTracks.dispatchEvent(new Event("change",{bubbles:!0,composed:!0})),n}var t4="cuepoints",t5=Object.freeze({label:t4});async function t3(e,t,r=t5){return t8(e,t,r.label,"metadata")}var t6=e=>({time:e.startTime,value:JSON.parse(e.text)});function t7(e,t={label:t4}){let r=t2(e,t.label,"metadata");return null!=r&&r.cues?Array.from(r.cues,e=>t6(e)):[]}function t9(e,t={label:t4}){var r,i;let n=t2(e,t.label,"metadata");if(!(null!=(r=null==n?void 0:n.activeCues)&&r.length))return;if(1===n.activeCues.length)return t6(n.activeCues[0]);let{currentTime:a}=e;return t6(Array.prototype.find.call(null!=(i=n.activeCues)?i:[],({startTime:e,endTime:t})=>e<=a&&t>a)||n.activeCues[0])}async function re(e,t=t5){return new Promise(r=>{tF(e,"loadstart",async()=>{let i=await t3(e,[],t);tF(e,"cuechange",()=>{let t=t9(e);if(t){let r=new CustomEvent("cuepointchange",{composed:!0,bubbles:!0,detail:t});e.dispatchEvent(r)}},{},i),r(i)})})}var rt="chapters",rr=Object.freeze({label:rt}),ri=e=>({startTime:e.startTime,endTime:e.endTime,value:e.text});async function rn(e,t,r=rr){return t8(e,t,r.label,"chapters")}function ra(e,t={label:rt}){var r;let i=t2(e,t.label,"chapters");return null!=(r=null==i?void 0:i.cues)&&r.length?Array.from(i.cues,e=>ri(e)):[]}function rs(e,t={label:rt}){var r,i;let n=t2(e,t.label,"chapters");if(!(null!=(r=null==n?void 0:n.activeCues)&&r.length))return;if(1===n.activeCues.length)return ri(n.activeCues[0]);let{currentTime:a}=e;return ri(Array.prototype.find.call(null!=(i=n.activeCues)?i:[],({startTime:e,endTime:t})=>e<=a&&t>a)||n.activeCues[0])}async function ro(e,t=rr){return new Promise(r=>{tF(e,"loadstart",async()=>{let i=await rn(e,[],t);tF(e,"cuechange",()=>{let t=rs(e);if(t){let r=new CustomEvent("chapterchange",{composed:!0,bubbles:!0,detail:t});e.dispatchEvent(r)}},{},i),r(i)})})}function rl(e,t){if(t){let r=t.playingDate;if(null!=r)return new Date(r.getTime()-1e3*e.currentTime)}return"function"==typeof e.getStartDate?e.getStartDate():new Date(NaN)}function ru(e,t){return t&&t.playingDate?t.playingDate:new Date("function"==typeof e.getStartDate?e.getStartDate().getTime()+1e3*e.currentTime:NaN)}var rc,rd,rh,rf=async e=>fetch(e).then(e=>e.text()).then(e=>fetch(e.split(`
`).find((e,t,r)=>t&&r[t-1].startsWith("#EXT-X-STREAM-INF"))).then(e=>e.text()).then(e=>e.split(`
`))),rp=e=>{var t,r,i;let n=null==(r=(null!=(t=e.find(e=>e.startsWith("#EXT-X-PLAYLIST-TYPE")))?t:"").split(":")[1])?void 0:r.trim(),a=tW(n),s=tV(n),o;if(a===tL.LIVE){let t=e.find(e=>e.startsWith("#EXT-X-PART-INF"));if(t)o=2*+t.split(":")[1].split("=")[1];else{let t=e.find(e=>e.startsWith("#EXT-X-TARGETDURATION")),r=null==(i=null==t?void 0:t.split(":"))?void 0:i[1];o=3*+(null!=r?r:6)}}return{streamType:a,targetLiveWindow:s,liveEdgeStartOffset:o}},rv=async(e,t)=>t===tN.MP4?{streamType:tL.ON_DEMAND,targetLiveWindow:Number.NaN,liveEdgeStartOffset:void 0}:t===tN.M3U8?rp(await rf(e)):(console.error(`Media type ${t} is an unrecognized or unsupported type for src ${e}.`),{streamType:void 0,targetLiveWindow:void 0,liveEdgeStartOffset:void 0}),rm=async(e,t,r=tz({src:e}))=>{var i,n,a;let{streamType:s,targetLiveWindow:o,liveEdgeStartOffset:l}=await rv(e,r);(null!=(i=rb.get(t))?i:{}).liveEdgeStartOffset=l,(null!=(n=rb.get(t))?n:{}).targetLiveWindow=o,t.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0})),(null!=(a=rb.get(t))?a:{}).streamType=s,t.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}))},ry=e=>{var t;let r=e.type,i=tW(r),n=tV(r),a,s=!!(null!=(t=e.partList)&&t.length);return i===tL.LIVE&&(a=s?2*e.partTarget:3*e.targetduration),{streamType:i,targetLiveWindow:n,liveEdgeStartOffset:a,lowLatency:s}},r_=(e,t,r)=>{var i,n,a,s,o,l,u,c;let{streamType:d,targetLiveWindow:h,liveEdgeStartOffset:f,lowLatency:p}=ry(e);if(d===tL.LIVE){p?(r.config.backBufferLength=null!=(i=r.userConfig.backBufferLength)?i:4,r.config.maxFragLookUpTolerance=null!=(n=r.userConfig.maxFragLookUpTolerance)?n:.001,r.config.abrBandWidthUpFactor=null!=(a=r.userConfig.abrBandWidthUpFactor)?a:r.config.abrBandWidthFactor):r.config.backBufferLength=null!=(s=r.userConfig.backBufferLength)?s:8;let e=Object.freeze({get length(){return t.seekable.length},start:e=>t.seekable.start(e),end(e){var i;return e>this.length||e<0||Number.isFinite(t.duration)?t.seekable.end(e):null!=(i=r.liveSyncPosition)?i:t.seekable.end(e)}});(null!=(o=rb.get(t))?o:{}).seekable=e}(null!=(l=rb.get(t))?l:{}).liveEdgeStartOffset=f,(null!=(u=rb.get(t))?u:{}).targetLiveWindow=h,t.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0})),(null!=(c=rb.get(t))?c:{}).streamType=d,t.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}))},rg=-1!==(null!=(rd=null==(rc=null==globalThis?void 0:globalThis.navigator)?void 0:rc.userAgent)?rd:"").toLowerCase().indexOf("android"),rb=new WeakMap,rw="mux.com",rT=null==(rh=tx.isSupported)?void 0:rh.call(tx),rk=()=>tE.utils.now(),rE=tE.utils.generateUUID,rS=({playbackId:e,customDomain:t=rw,maxResolution:r,minResolution:i,renditionOrder:n,programStartTime:a,programEndTime:s,tokens:{playback:o}={},extraSourceParams:l={}}={})=>{if(!e)return;let[u,c=""]=tH(e),d=new URL(`https://stream.${t}/${u}.m3u8${c}`);return o||d.searchParams.has("token")?(d.searchParams.forEach((e,t)=>{"token"!=t&&d.searchParams.delete(t)}),o&&d.searchParams.set("token",o)):(r&&d.searchParams.set("max_resolution",r),i&&(d.searchParams.set("min_resolution",i),r&&+r.slice(0,-1)<+i.slice(0,-1)&&console.error("minResolution must be <= maxResolution","minResolution",i,"maxResolution",r)),n&&d.searchParams.set("rendition_order",n),a&&d.searchParams.set("program_start_time",`${a}`),s&&d.searchParams.set("program_end_time",`${s}`),Object.entries(l).forEach(([e,t])=>{null!=t&&d.searchParams.set(e,t)})),d.toString()},rx=e=>{if(!e)return;let[t]=e.split("?");return t||void 0},rO=e=>{if(!e||!e.startsWith("https://stream."))return;let[t]=new URL(e).pathname.slice(1).split(".m3u8");return t||void 0},rA=e=>{var t,r,i;return null!=(t=null==e?void 0:e.metadata)&&t.video_id?e.metadata.video_id:rY(e)&&null!=(i=null!=(r=rx(e.playbackId))?r:rO(e.src))?i:e.src},rR=e=>{var t;return null==(t=rb.get(e))?void 0:t.error},rP=e=>{var t,r;return null!=(r=null==(t=rb.get(e))?void 0:t.streamType)?r:tL.UNKNOWN},rD=e=>{var t,r;return null!=(r=null==(t=rb.get(e))?void 0:t.targetLiveWindow)?r:Number.NaN},rL=e=>{var t,r;return null!=(r=null==(t=rb.get(e))?void 0:t.seekable)?r:e.seekable},rC=e=>{var t;let r=null==(t=rb.get(e))?void 0:t.liveEdgeStartOffset;if("number"!=typeof r)return Number.NaN;let i=rL(e);return i.length?i.end(i.length-1)-r:Number.NaN},rI=.034,rj=(e,t,r=rI)=>Math.abs(e-t)<=r,rN=(e,t,r=rI)=>e>t||rj(e,t,r),rU=(e,t=rI)=>e.paused&&rN(e.currentTime,e.duration,t),rq=(e,t)=>{var r,i,n;if(!t||!e.buffered.length)return;if(e.readyState>2)return!1;let a=t.currentLevel>=0?null==(i=null==(r=t.levels)?void 0:r[t.currentLevel])?void 0:i.details:null==(n=t.levels.find(e=>!!e.details))?void 0:n.details;if(!a||a.live)return;let{fragments:s}=a;if(!(null!=s&&s.length))return;if(e.currentTime<e.duration-(a.targetduration+.5))return!1;let o=s[s.length-1];if(e.currentTime<=o.start)return!1;let l=o.start+o.duration/2,u=e.buffered.start(e.buffered.length-1),c=e.buffered.end(e.buffered.length-1);return l>u&&l<c},r$=(e,t)=>e.ended||e.loop?e.ended:!!(t&&rq(e,t))||rU(e),rB=(e,t,r)=>{rM(t,r);let{metadata:i={}}=e,{view_session_id:n=rE()}=i,a=rA(e);i.view_session_id=n,i.video_id=a,e.metadata=i,rb.set(t,{});let s=rH(e,t),o=tX(e,t,s);rX(e,t,s),rZ(e,t,s),re(t),ro(t);let l=tQ(e,t,s);return{engine:s,setAutoplay:l,setPreload:o}},rM=(e,t)=>{let r=null==t?void 0:t.engine;r&&(r.detachMedia(),r.destroy()),null!=e&&e.mux&&!e.mux.deleted&&(e.mux.destroy(),delete e.mux),e&&(e.removeAttribute("src"),e.load(),e.removeEventListener("error",r1),e.removeEventListener("error",r2),e.removeEventListener("durationchange",r0),rb.delete(e),e.dispatchEvent(new Event("teardown")))};function rF(e,t){var r;let i=tz(e);if(i!==tN.M3U8)return!0;let n=!i||null==(r=t.canPlayType(i))||r,{preferPlayback:a}=e,s=a===tC.MSE,o=a===tC.NATIVE;return n&&(o||!(rT&&(s||rg)))}var rH=(e,t)=>{let{debug:r,streamType:i,startTime:n=-1,metadata:a,preferCmcd:s,_hlsConfig:o={}}=e,l=tz(e)===tN.M3U8,u=rF(e,t);if(l&&!u&&rT){let t=rz(i),l=rW(e);return new tx({debug:r,startPosition:n,cmcd:s!==tI.NONE?{useHeaders:s===tI.HEADER,sessionId:null==a?void 0:a.view_session_id,contentId:null==a?void 0:a.video_id}:void 0,xhrSetup:(e,t)=>{var r,i;if(s&&s!==tI.QUERY)return;let n=new URL(t);if(!n.searchParams.has("CMCD"))return;let a=(null!=(i=null==(r=n.searchParams.get("CMCD"))?void 0:r.split(","))?i:[]).filter(e=>e.startsWith("sid")||e.startsWith("cid")).join(",");n.searchParams.set("CMCD",a),e.open("GET",n)},backBufferLength:30,renderTextTracksNatively:!1,liveDurationInfinity:!0,capLevelToPlayerSize:!0,capLevelOnFPSDrop:!0,...t,...l,...o})}},rz=e=>e===tL.LIVE?{backBufferLength:8}:{},rW=e=>{let{drmToken:t,src:r,playbackId:i=rO(r)}=e;return t&&i?{emeEnabled:!0,drmSystems:{"com.apple.fps":{licenseUrl:rJ(e,"fairplay"),serverCertificateUrl:rQ(e,"fairplay")},"com.widevine.alpha":{licenseUrl:rJ(e,"widevine")},"com.microsoft.playready":{licenseUrl:rJ(e,"playready")}},requestMediaKeySystemAccessFunc:(e,t)=>("com.widevine.alpha"===e&&(t=[...t.map(e=>{var t;let r=null==(t=e.videoCapabilities)?void 0:t.map(e=>({...e,robustness:"HW_SECURE_ALL"}));return{...e,videoCapabilities:r}}),...t]),navigator.requestMediaKeySystemAccess(e,t))}:{}},rV=async e=>await (await fetch(e)).arrayBuffer(),rG=async(e,t)=>new Uint8Array(await (await fetch(t,{method:"POST",headers:{"Content-type":"application/octet-stream"},body:e})).arrayBuffer()),rK=(e,t)=>{tF(t,"encrypted",async r=>{try{let i=r.initDataType;if("skd"!==i){console.error(`Received unexpected initialization data type "${i}"`);return}if(!t.mediaKeys){let r=await (await navigator.requestMediaKeySystemAccess("com.apple.fps",[{initDataTypes:[i],videoCapabilities:[{contentType:"application/vnd.apple.mpegurl",robustness:""}],distinctiveIdentifier:"not-allowed",persistentState:"not-allowed",sessionTypes:["temporary"]}])).createMediaKeys(),n=await rV(rQ(e,"fairplay"));await r.setServerCertificate(n),await t.setMediaKeys(r)}let n=r.initData;if(null==n){console.error(`Could not start encrypted playback due to missing initData in ${r.type} event`);return}let a=t.mediaKeys.createSession();a.generateRequest(i,n);let s=await new Promise(e=>{a.addEventListener("message",t=>{e(t.message)},{once:!0})}),o=await rG(s,rJ(e,"fairplay"));return await a.update(o),a}catch(e){console.error(`Could not start encrypted playback due to exception "${e}"`)}})},rJ=({playbackId:e,drmToken:t,customDomain:r=rw},i)=>`https://license.${r.toLocaleLowerCase().endsWith(rw)?r:rw}/license/${i}/${e}?token=${t}`,rQ=({playbackId:e,drmToken:t,customDomain:r=rw},i)=>`https://license.${r.toLocaleLowerCase().endsWith(rw)?r:rw}/appcert/${i}/${e}?token=${t}`,rY=({playbackId:e,src:t,customDomain:r})=>{if(e)return!0;if("string"!=typeof t)return!1;let i=new URL(t,null==window?void 0:window.location.href).hostname.toLocaleLowerCase();return i.includes(rw)||!!r&&i.includes(r.toLocaleLowerCase())},rX=(e,t,r)=>{var i;let{envKey:n,disableTracking:a}=e,s=rY(e);if(!a&&(n||s)){let{playerInitTime:a,playerSoftwareName:s,playerSoftwareVersion:o,beaconCollectionDomain:l,debug:u,disableCookies:c}=e,d={...e.metadata,video_title:(null==(i=null==e?void 0:e.metadata)?void 0:i.video_title)||void 0};tE.monitor(t,{debug:u,beaconCollectionDomain:l,hlsjs:r,Hls:r?tx:void 0,automaticErrorTracking:!1,errorTranslator:t=>"string"!=typeof t.player_error_code&&("function"==typeof e.errorTranslator?e.errorTranslator(t):t),disableCookies:c,data:{...n?{env_key:n}:{},player_software_name:s,player_software:s,player_software_version:o,player_init_time:a,...d}})}},rZ=(e,t,r)=>{var i;let n=rF(e,t),{src:a}=e,s=()=>{t.ended||!r$(t,r)||(rq(t,r)?t.currentTime=t.buffered.end(t.buffered.length-1):t.dispatchEvent(new Event("ended")))},o,l,u=()=>{var e,r;let i=null==(e=rL(t))?void 0:e.start(0),n=null==(r=rL(t))?void 0:r.end(0);(l!==n||o!==i)&&t.dispatchEvent(new CustomEvent("seekablechange",{composed:!0})),o=i,l=n};if(tF(t,"durationchange",u),t&&n){let r=tz(e);if("string"==typeof a){let n=()=>{if(rP(t)!==tL.LIVE||Number.isFinite(t.duration))return;let e=setInterval(u,1e3);t.addEventListener("teardown",()=>{clearInterval(e)},{once:!0}),tF(t,"durationchange",()=>{Number.isFinite(t.duration)&&clearInterval(e)})};if("none"===t.preload){let e=()=>{rm(a,t,r).then(n),t.removeEventListener("loadedmetadata",i)},i=()=>{rm(a,t,r).then(n),t.removeEventListener("play",e)};tF(t,"play",e,{once:!0}),tF(t,"loadedmetadata",i,{once:!0})}else rm(a,t,r).then(n);e.drmToken&&rK(e,t),t.setAttribute("src",a),e.startTime&&((null!=(i=rb.get(t))?i:{}).startTime=e.startTime,t.addEventListener("durationchange",r0,{once:!0}))}else t.removeAttribute("src");t.addEventListener("error",r1),t.addEventListener("error",r2),t.addEventListener("emptied",()=>{t.querySelectorAll("track[data-removeondestroy]").forEach(e=>{e.remove()})},{once:!0}),tF(t,"pause",s),tF(t,"seeked",s),tF(t,"play",()=>{t.ended||rN(t.currentTime,t.duration)&&(t.currentTime=t.seekable.start(0))})}else r&&a?(r.once(tx.Events.LEVEL_LOADED,(e,i)=>{r_(i.details,t,r),u(),rP(t)!==tL.LIVE||Number.isFinite(t.duration)||(r.on(tx.Events.LEVEL_UPDATED,u),tF(t,"durationchange",()=>{Number.isFinite(t.duration)&&r.off(tx.Events.LEVELS_UPDATED,u)}))}),r.on(tx.Events.ERROR,(e,r)=>{let i={[tx.ErrorTypes.NETWORK_ERROR]:tA.MEDIA_ERR_NETWORK,[tx.ErrorTypes.MEDIA_ERROR]:tA.MEDIA_ERR_DECODE},n=new tA("",i[r.type]);n.fatal=r.fatal,n.data=r,t.dispatchEvent(new CustomEvent("error",{detail:n}))}),t.addEventListener("error",r2),tF(t,"waiting",s),function(e,t){var r;if(!("videoTracks"in e))return;let i=new WeakMap;t.on(tx.Events.MANIFEST_PARSED,function(t,r){o();let n=e.addVideoTrack("main");for(let[e,t]of(n.selected=!0,r.levels.entries())){let r=n.addRendition(t.url[0],t.width,t.height,t.videoCodec,t.bitrate);i.set(t,`${e}`),r.id=`${e}`}}),t.on(tx.Events.AUDIO_TRACKS_UPDATED,function(t,r){for(let t of(s(),r.audioTracks)){let r=t.default?"main":"alternative",i=e.addAudioTrack(r,t.name,t.lang);i.id=`${t.id}`,t.default&&(i.enabled=!0)}}),e.audioTracks.addEventListener("change",()=>{var r;let i=+(null==(r=[...e.audioTracks].find(e=>e.enabled))?void 0:r.id),n=t.audioTracks.map(e=>e.id);i!=t.audioTrack&&n.includes(i)&&(t.audioTrack=i)}),t.on(tx.Events.LEVELS_UPDATED,function(t,r){var n;let a=e.videoTracks[null!=(n=e.videoTracks.selectedIndex)?n:0];if(!a)return;let s=r.levels.map(e=>i.get(e));for(let t of e.videoRenditions)t.id&&!s.includes(t.id)&&a.removeRendition(t)});let n=r=>{let i=e.currentTime,n=!1,a=(e,t)=>{n||(n=!Number.isFinite(t.endOffset))};t.on(tx.Events.BUFFER_FLUSHING,a),t.nextLevel=r,t.off(tx.Events.BUFFER_FLUSHING,a),n||t.trigger(tx.Events.BUFFER_FLUSHING,{startOffset:i+10,endOffset:1/0,type:"video"})};null==(r=e.videoRenditions)||r.addEventListener("change",e=>{let r=e.target.selectedIndex;r!=t.nextLevel&&n(r)});let a=()=>{for(let t of e.videoTracks)e.removeVideoTrack(t)},s=()=>{for(let t of e.audioTracks)e.removeAudioTrack(t)},o=()=>{a(),s()};t.once(tx.Events.DESTROYING,o)}(e,r),function(e,t){t.on(tx.Events.NON_NATIVE_TEXT_TRACKS_FOUND,(r,{tracks:i})=>{i.forEach(r=>{var i;let n=null!=(i=r.subtitleTrack)?i:r.closedCaptions,a=t.subtitleTracks.findIndex(({lang:e,name:t,type:i})=>e==(null==n?void 0:n.lang)&&t===r.label&&i.toLowerCase()===r.kind);t0(e,r.kind,r.label,null==n?void 0:n.lang,`${r.kind}${a}`)})});let r=()=>{var r;if(!t.subtitleTracks.length)return;let i=Array.from(e.textTracks).find(e=>e.id&&"showing"===e.mode&&["subtitles","captions"].includes(e.kind)),n=`${null==(r=t.subtitleTracks[t.subtitleTrack])?void 0:r.type.toLowerCase()}${t.subtitleTrack}`;if(i&&(t.subtitleTrack<0||(null==i?void 0:i.id)!==n)){let e=t.subtitleTracks.findIndex(({lang:e,name:t,type:r})=>e==i.language&&t===i.label&&r.toLowerCase()===i.kind);t.subtitleTrack=e}i&&(null==i?void 0:i.id)===n&&i.cues&&Array.from(i.cues).forEach(e=>{i.addCue(e)})};e.textTracks.addEventListener("change",r),t.on(tx.Events.CUES_PARSED,(t,{track:r,cues:i})=>{let n=e.textTracks.getTrackById(r);if(!n)return;let a="disabled"===n.mode;a&&(n.mode="hidden"),i.forEach(e=>{var t;null!=(t=n.cues)&&t.getCueById(e.id)||n.addCue(e)}),a&&(n.mode="disabled")}),t.once(tx.Events.DESTROYING,()=>{e.textTracks.removeEventListener("change",r),e.querySelectorAll("track[data-removeondestroy]").forEach(e=>{e.remove()})});let i=()=>{Array.from(e.textTracks).forEach(t=>{var r,i;if(!["subtitles","caption"].includes(t.kind)&&"thumbnails"===t.label){if(!(null!=(r=t.cues)&&r.length)){let t=e.querySelector('track[label="thumbnails"]'),r=null!=(i=null==t?void 0:t.getAttribute("src"))?i:"";null==t||t.removeAttribute("src"),setTimeout(()=>{null==t||t.setAttribute("src",r)},0)}"hidden"!==t.mode&&(t.mode="hidden")}})};t.once(tx.Events.MANIFEST_LOADED,i),t.once(tx.Events.MEDIA_ATTACHED,i)}(t,r),r.attachMedia(t)):console.error("It looks like the video you're trying to play will not work on this system! If possible, try upgrading to the newest versions of your browser or software.")};function r0(e){var t;let r=e.target,i=null==(t=rb.get(r))?void 0:t.startTime;if(i&&function(e,t,r){t&&r>t&&(r=t);for(let t=0;t<e.length;t++)if(e.start(t)<=r&&e.end(t)>=r)return!0;return!1}(r.seekable,r.duration,i)){let e="auto"===r.preload;e&&(r.preload="none"),r.currentTime=i,e&&(r.preload="auto")}}async function r1(e){if(!e.isTrusted)return;e.stopImmediatePropagation();let t=e.target;if(!(null!=t&&t.error))return;let{message:r,code:i}=t.error,n=new tA(r,i);if(t.src&&(i!==tA.MEDIA_ERR_DECODE||void 0!==i))try{let{status:e}=await fetch(t.src);n.data={response:{code:e}}}catch{}t.dispatchEvent(new CustomEvent("error",{detail:n}))}function r2(e){var t,r;if(!(e instanceof CustomEvent)||!(e.detail instanceof tA))return;let i=e.target,n=e.detail;n&&n.fatal&&((null!=(t=rb.get(i))?t:{}).error=n,null==(r=i.mux)||r.emit("error",{player_error_code:n.code,player_error_message:n.message,player_error_context:n.context}))}},5380:function(e,t,r){"use strict";r.d(t,{Z:function(){return C}});var i={};r.r(i),r.d(i,{getPlaybackId:function(){return y},getPosterURLFromPlaybackId:function(){return _},transform:function(){return m}});var n={};r.r(n),r.d(n,{transform:function(){return A}});var a={};r.r(a),r.d(a,{transform:function(){return R}});var s={};r.r(s),r.d(s,{transform:function(){return P}});var o={};r.r(o),r.d(o,{amazonS3:function(){return s},backblaze:function(){return a},mux:function(){return i},vercelBlob:function(){return n}});var l=r(7437),u=r(2265),c=r(1448),d=r(3759),h=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=(0,u.useRef)(null);return(0,u.useEffect)(()=>{t.forEach(e=>{e&&("function"==typeof e?e(i.current):e.current=i.current)})},[t]),i},f=(()=>{try{return"0.11.2"}catch(e){}return"UNKNOWN"})(),p=u.forwardRef((e,t)=>{var r;let{playbackId:i,src:n,children:a,autoPlay:s,preload:o,...l}=e,c=Object.fromEntries(Object.entries(l).filter(e=>{let[t]=e;return!Object.keys(p.propTypes).includes(t)})),[v]=(0,u.useState)((0,d.oJ)()),[m,y]=(0,u.useState)(null!=(r=(0,d.Lh)(e))?r:n),_=(0,u.useRef)(void 0),g=h((0,u.useRef)(null),t);return(0,u.useEffect)(()=>{var t;y(null!=(t=(0,d.Lh)(e))?t:n)},[n,i]),(0,u.useEffect)(()=>{let t={...e,src:m,playerInitTime:v,playerSoftwareName:"mux-video-react",playerSoftwareVersion:f,autoplay:s},r=g.current;return r&&(_.current=(0,d.j2)(t,r,_.current)),()=>{(0,d.cx)(r,_.current),r=void 0,_.current=void 0}},[m]),(0,u.useEffect)(()=>{var e;null==(e=_.current)||e.setAutoplay(s)},[s]),(0,u.useEffect)(()=>{var e;null==(e=_.current)||e.setPreload(o)},[o]),u.createElement("video",{ref:g,...c},a)});p.propTypes={_hlsConfig:c.any,beaconCollectionDomain:c.string,customDomain:c.string,debug:c.bool,disableCookies:c.bool,disableTracking:c.bool,envKey:c.string,errorTranslator:c.any,liveEdgeStart:c.number,maxResolution:c.oneOf(["720p","1080p","1440p","2160p"]),metadata:c.any,minResolution:c.oneOf(["480p","540p","720p","1080p","1440p","2160p"]),playbackId:c.string,playerInitTime:c.number,preferCmcd:c.oneOf(Object.values(d.XE)),preferPlayback:c.oneOf(Object.values(d.uI)),programStartTime:c.number,programEndTime:c.number,renditionOrder:c.oneOf(["desc"]),startTime:c.number,streamType:c.oneOf(Object.values(d.lo)),targetLiveWindow:c.number,tokens:c.any,type:c.oneOf(d.PZ)};let v="mux.com";function m(e,t){let r=y(e);if(!r)return e;let i=e.providerMetadata?.mux?.thumbnailTime??t?.thumbnailTime??t?.startTime,n={...e,sources:[{src:`https://stream.${t?.customDomain??v}/${r}.m3u8`,type:"application/x-mpegURL"}],poster:_(r,{thumbnailTime:i,customDomain:t?.customDomain,token:t?.tokens?.thumbnail})};return i>=0&&(n.thumbnailTime=i),n}function y(e){let t=e.providerMetadata?.mux??e.externalIds;return t?.playbackId}let _=(e,{token:t,thumbnailTime:r,width:i,customDomain:n=v}={})=>{let a=null==t?r:void 0,{aud:s}=function(e){let t=(e??"").split(".")[1];return t?JSON.parse(decodeURIComponent(atob(t.replace(/-/g,"+").replace(/_/g,"/")).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))):{}}(t);if(!t||"t"===s)return`https://image.${n}/${e}/thumbnail.webp${function(e){let t=(function(e){let t={};for(let r in e)null!=e[r]&&(t[r]=e[r]);return new URLSearchParams(t)})(e).toString();return t?"?"+t:""}({token:t,time:a,width:i})}`};var g=r(357);let b=JSON.parse(g.env.NEXT_PUBLIC_DEV_VIDEO_OPTS??g.env.NEXT_PUBLIC_VIDEO_OPTS??"{}"),w=`${b.folder??"videos"}/`;function T(e){return`<svg xmlns="http://www.w3.org/2000/svg"><filter id="b" color-interpolation-filters="sRGB"><feGaussianBlur stdDeviation="20"/><feComponentTransfer><feFuncA type="discrete" tableValues="1 1"/></feComponentTransfer></filter><g filter="url(#b)"><image width="100%" height="100%" preserveAspectRatio="xMidYMid slice" href="${e}"/></g></svg>`.replace(/#/g,"%23")}let k=(0,u.forwardRef)((e,t)=>{let r,{style:i,className:n,children:a,asset:s,controls:o,poster:c,blurDataURL:d,onPlaying:h,onLoadStart:f,...v}=e,m=u.Children.toArray(a).find(e=>"object"==typeof e&&"type"in e&&"poster"===e.props.slot);(0,u.isValidElement)(m)&&(c="",d=void 0);let g={},b=s?y(s):void 0,w=!0;if(!b||(null==s?void 0:s.status)!=="ready"||(v.src=void 0,v.playbackId=b,!c||(w=c!==_(b,v))||(r="".concat(_(b,{...v,width:480})," 480w,").concat(_(b,{...v,width:640})," 640w,").concat(_(b,{...v,width:960})," 960w,").concat(_(b,{...v,width:1280})," 1280w,").concat(_(b,{...v,width:1600})," 1600w,").concat(_(b,{...v})," 1920w"))),d){let e=!w&&d===(null==s?void 0:s.blurDataURL),t=w&&d!==(null==s?void 0:s.blurDataURL);(e||t)&&(g.width="100%",g.height="100%",g.color="transparent",g.backgroundSize="cover",g.backgroundPosition="center",g.backgroundRepeat="no-repeat",g.backgroundImage="url('data:image/svg+xml;charset=utf-8,".concat(T(d),"')"))}delete v.thumbnailTime;let[k,E]=(0,u.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("style",{children:"\n        .next-video-bg {\n          width: 100%;\n          height: 100%;\n          display: grid;\n        }\n\n        .next-video-bg-video,\n        .next-video-bg-poster,\n        .next-video-bg-text {\n          grid-area: 1 / 1;\n          min-height: 0;\n        }\n\n        .next-video-bg-poster {\n          position: relative;\n          object-fit: cover;\n          pointer-events: none;\n          transition: opacity .25s;\n        }\n\n        .next-video-bg-poster[hidden] {\n          opacity: 0;\n        }\n\n        .next-video-bg-video {\n          object-fit: cover;\n        }\n\n        .next-video-bg-text {\n          position: relative;\n          display: grid;\n          place-content: center;\n          padding: 5% 5% 10%;\n        }\n        "}),(0,l.jsxs)("div",{className:"".concat(n?"".concat(n," "):"","next-video-bg"),style:{...i},children:[(0,l.jsx)(p,{ref:t,className:"next-video-bg-video",onPlaying:e=>{null==h||h(e),E(!0)},onLoadStart:e=>{null==f||f(e),E(!1)},muted:!0,autoPlay:!0,loop:!0,playsInline:!0,...v}),c&&(0,l.jsx)("img",{className:"next-video-bg-poster",src:w?c:void 0,srcSet:r,style:g,hidden:k,decoding:"async","aria-hidden":"true"}),(0,l.jsx)("div",{className:"next-video-bg-text",children:a})]})]})}),E=(0,u.lazy)(()=>r.e(484).then(r.bind(r,8484))),S=(0,u.forwardRef)((e,t)=>{let r,{style:i,children:n,asset:a,controls:s,poster:o,blurDataURL:c,...d}=e,h=u.Children.toArray(n).find(e=>"object"==typeof e&&"type"in e&&"poster"===e.props.slot);(0,u.isValidElement)(h)&&(o="",c=void 0);let f={},p=a?y(a):void 0,v=!0;if(!p||(null==a?void 0:a.status)!=="ready"||(d.src=null,d.playbackId=p,!o||(v=o!==_(p,d))||(r="".concat(_(p,{...d,width:480})," 480w,").concat(_(p,{...d,width:640})," 640w,").concat(_(p,{...d,width:960})," 960w,").concat(_(p,{...d,width:1280})," 1280w,").concat(_(p,{...d,width:1600})," 1600w,").concat(_(p,{...d})," 1920w"))),c){let e=!v&&c===(null==a?void 0:a.blurDataURL),t=v&&c!==(null==a?void 0:a.blurDataURL);(e||t)&&(f.width="100%",f.height="100%",f.color="transparent",f.backgroundSize="cover",f.backgroundPosition="center",f.backgroundRepeat="no-repeat",f.backgroundImage="url('data:image/svg+xml;charset=utf-8,".concat(T(c),"')"))}return o&&(n=(0,l.jsxs)(l.Fragment,{children:[n,(0,l.jsx)("img",{slot:"poster",src:v?o:void 0,srcSet:r,style:f,decoding:"async","aria-hidden":"true"})]}),o=""),(0,l.jsx)(u.Suspense,{fallback:null,children:(0,l.jsx)(E,{ref:t,style:{"--controls":!1===s?"none":void 0,...i},children:n,poster:o,...d})})});function x({status:e,hidden:t}){let r="",i="";switch(e){case"error":r="Error",i="An error occurred while uploading your video. Please check the CLI logs for more info.";break;case"sourced":r="Video is not processing",i="Make sure to run next-video sync. The currently loaded video is the source file.";break;default:r="Upload in progress...",i="Your video file is being uploaded. The currently loaded video is the source file."}return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("style",{children:`
        .next-video-alert {
          position: absolute;
          inset: 1em;
          bottom: auto;
          padding: .75rem 1rem;
          border-radius: 1rem;
          color: hsl(0, 0%, 100%);
          background-color: hsl(240 10% 3.9% / .7);
          border: 1px solid hsl(240 3.7% 15.9%);
          transition: visibility 0s, opacity .25s;
          visibility: visible;
          opacity: 1;
        }

        .next-video-alert[hidden] {
          display: block;
          transition: visibility 1s, opacity 1s;
          visibility: hidden;
          opacity: 0;
        }

        .next-video-alert svg {
          position: absolute;
        }

        .next-video-alert h5 {
          line-height: 1;
          font-weight: 500;
          margin-bottom: 0.25rem;
          padding-left: 1.75rem;
          font-size: inherit;
        }

        .next-video-alert div {
          padding-left: 1.75rem;
          font-size: 0.875rem;
          line-height: 1.25rem;
        }
        `}),(0,l.jsxs)("div",{role:"alert",className:`next-video-alert next-video-alert-${e}`,hidden:t,children:["error"===e?(0,l.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",children:(0,l.jsx)("path",{d:"M0.877075 7.49988C0.877075 3.84219 3.84222 0.877045 7.49991 0.877045C11.1576 0.877045 14.1227 3.84219 14.1227 7.49988C14.1227 11.1575 11.1576 14.1227 7.49991 14.1227C3.84222 14.1227 0.877075 11.1575 0.877075 7.49988ZM7.49991 1.82704C4.36689 1.82704 1.82708 4.36686 1.82708 7.49988C1.82708 10.6329 4.36689 13.1727 7.49991 13.1727C10.6329 13.1727 13.1727 10.6329 13.1727 7.49988C13.1727 4.36686 10.6329 1.82704 7.49991 1.82704ZM9.85358 5.14644C10.0488 5.3417 10.0488 5.65829 9.85358 5.85355L8.20713 7.49999L9.85358 9.14644C10.0488 9.3417 10.0488 9.65829 9.85358 9.85355C9.65832 10.0488 9.34173 10.0488 9.14647 9.85355L7.50002 8.2071L5.85358 9.85355C5.65832 10.0488 5.34173 10.0488 5.14647 9.85355C4.95121 9.65829 4.95121 9.3417 5.14647 9.14644L6.79292 7.49999L5.14647 5.85355C4.95121 5.65829 4.95121 5.3417 5.14647 5.14644C5.34173 4.95118 5.65832 4.95118 5.85358 5.14644L7.50002 6.79289L9.14647 5.14644C9.34173 4.95118 9.65832 4.95118 9.85358 5.14644Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}):(0,l.jsx)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",children:(0,l.jsx)("path",{d:"M8.4449 0.608765C8.0183 -0.107015 6.9817 -0.107015 6.55509 0.608766L0.161178 11.3368C-0.275824 12.07 0.252503 13 1.10608 13H13.8939C14.7475 13 15.2758 12.07 14.8388 11.3368L8.4449 0.608765ZM7.4141 1.12073C7.45288 1.05566 7.54712 1.05566 7.5859 1.12073L13.9798 11.8488C14.0196 11.9154 13.9715 12 13.8939 12H1.10608C1.02849 12 0.980454 11.9154 1.02018 11.8488L7.4141 1.12073ZM6.8269 4.48611C6.81221 4.10423 7.11783 3.78663 7.5 3.78663C7.88217 3.78663 8.18778 4.10423 8.1731 4.48612L8.01921 8.48701C8.00848 8.766 7.7792 8.98664 7.5 8.98664C7.2208 8.98664 6.99151 8.766 6.98078 8.48701L6.8269 4.48611ZM8.24989 10.476C8.24989 10.8902 7.9141 11.226 7.49989 11.226C7.08567 11.226 6.74989 10.8902 6.74989 10.476C6.74989 10.0618 7.08567 9.72599 7.49989 9.72599C7.9141 9.72599 8.24989 10.0618 8.24989 10.476Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}),(0,l.jsx)("h5",{children:r}),(0,l.jsx)("div",{children:i})]})]})}async function O({config:e,src:t,width:r,height:i}){let n=`${e.path}?url=${encodeURIComponent(`${t}`)}`;return r&&(n+=`&w=${r}`),i&&(n+=`&h=${i}`),`${n}`}function A(e){let t=e.providerMetadata?.["vercel-blob"]??e.externalIds;if(!t)return e;let r={src:t.url};return t.contentType&&(r.type=t.contentType),{...e,sources:[r]}}function R(e){let t=e.providerMetadata?.backblaze;if(!t)return e;let r=new URL(t.endpoint);r.hostname=`${t.bucket}.${r.hostname}`,r.pathname=t.key;let i={src:`${r}`};return{...e,sources:[i]}}function P(e){let t=e.providerMetadata?.["amazon-s3"];if(!t)return e;let r=new URL(t.endpoint);r.hostname=`${t.bucket}.${r.hostname}`,r.pathname=t.key;let i={src:`${r}`};return{...e,sources:[i]}}let D=(0,u.forwardRef)((e,t)=>{var r;let{as:i=S,loader:n=O,transform:a=L,className:s,style:o,src:c,width:d,height:h}=e,[f,p]=(0,u.useState)("object"==typeof c?c:void 0),[v,m]=(0,u.useState)(!1);"object"==typeof c&&(f=c,c=void 0);let y={src:c,width:d,height:h},_=(r=e=>p(e),async e=>{if("string"==typeof y.src)try{let t=await n({...y,config:b}),i=await fetch(t,{signal:e}),a=await i.json();if(i.ok)r(a);else{let e=`[next-video] The request to ${i.url} failed. `;throw e+=`Did you configure the \`${b.path}\` route to handle video API requests?
`,Error(e)}}catch(t){e.aborted||console.error(t)}}),g=null==f?void 0:f.status,T=function(e){if("string"==typeof e)return e.split(/[#?]/)[0].split(".").pop()?.trim()}(c);!function(e,t=5e3){let r=(0,u.useRef)(new AbortController);(0,u.useEffect)(()=>(r.current=new AbortController,e(r.current.signal),()=>{r.current.abort()}),[]),function(e,t){let r=(0,u.useRef)();(0,u.useEffect)(()=>{r.current=e},[e]),(0,u.useEffect)(()=>{let e;let i=async()=>{await r.current?.(),null!=t&&(e=setTimeout(i,t))};if(null!=t)return e=setTimeout(i,t),()=>clearTimeout(e)},[t])}((0,u.useCallback)(()=>e(r.current.signal),[]),t)}(_,"string"!=typeof c||"ready"==g||["m3u8","mpd"].includes(null!=T?T:"")?null:1e3);let k=function(e,t){var r,i,n,a,s,o,l;let{asset:u}=t,{controls:c=!0,as:d,className:h,style:f,src:p,poster:v,blurDataURL:m,loader:y,transform:_,...g}=e,b={src:p,controls:c,blurDataURL:m,...g};if("object"==typeof v?(b.poster=v.src,null!==(r=b.blurDataURL)&&void 0!==r||(b.blurDataURL=v.blurDataURL)):b.poster=v,u){if("ready"===u.status){null!==(i=b.blurDataURL)&&void 0!==i||(b.blurDataURL=u.blurDataURL);let e=_(u,b);e&&(b.src=null===(a=e.sources)||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:n.src,null!==(s=b.poster)&&void 0!==s||(b.poster=e.poster),null!==(o=b.thumbnailTime)&&void 0!==o||(b.thumbnailTime=e.thumbnailTime))}else b.src=(l=u.originalFilePath,l?.startsWith(w)?l?.replace(w,"_next-video/"):l)}return b}({...e,transform:a,src:c},{asset:f});return!("function"==typeof i&&(()=>{let e=Object.getPrototypeOf(i);return e.prototype&&e.prototype.isReactComponent})()||"function"==typeof i||"object"==typeof i&&"symbol"==typeof i.$$typeof&&["react.memo","react.forward_ref"].includes(i.$$typeof.description))&&console.warn("The `as` property is not a valid component:",i),(0,l.jsxs)("div",{className:"".concat(s?"".concat(s," "):"","next-video-container"),style:o,children:[(0,l.jsx)("style",{children:"\n        .next-video-container {\n          position: relative;\n          width: 100%;\n          aspect-ratio: 16 / 9;\n        }\n\n        [data-next-video] {\n          display: block;\n          position: relative;\n          width: 100%;\n          height: 100%;\n        }\n\n        [data-next-video] img {\n          object-fit: var(--media-object-fit, contain);\n          object-position: var(--media-object-position, center);\n        }\n        "}),(0,l.jsx)(i,{ref:t,"data-next-video":null!=g?g:"",style:{width:d,height:h},asset:f,onPlaying:()=>m(!0),onPause:()=>m(!1),...k}),(0,l.jsx)(x,{hidden:!!(v||!g||"ready"===g),status:g})]})});function L(e,t){var r;let i=null!==(r=e.provider)&&void 0!==r?r:b.provider;for(let[r,n]of Object.entries(o))if(r===i.replace(/[-_]([a-z])/g,(e,t)=>t.toUpperCase()))return n.transform(e,t)}var C=(0,u.forwardRef)((e,t)=>(0,l.jsx)(D,{ref:t,as:k,thumbnailTime:0,...e}))}}]);